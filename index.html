<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2024-09-18 Wed 00:41 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>ニューロシンボリック Classical Planning</title>
<meta name="author" content="Masataro Asai" />
<meta name="generator" content="Org Mode" />
<style>
  #content { max-width: 60em; margin: auto; }
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #e6e6e6;
    border-radius: 3px;
    background-color: #f2f2f2;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: auto;
  }
  pre.src:before {
    display: none;
    position: absolute;
    top: -8px;
    right: 12px;
    padding: 3px;
    color: #555;
    background-color: #f2f2f299;
  }
  pre.src:hover:before { display: inline; margin-top: 14px;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-authinfo::before { content: 'Authinfo'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .equation-container {
    display: table;
    text-align: center;
    width: 100%;
  }
  .equation {
    vertical-align: middle;
  }
  .equation-label {
    display: table-cell;
    text-align: right;
    vertical-align: middle;
  }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { }
</style>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" type="text/css" href="css/layout.css" />
<link rel="stylesheet" type="text/css" href="css/default.css" />
<script type="text/javascript" src="js/jquery-3.6.1.min.js"></script>
<script type="text/javascript" src="js/jquery.loupe.min.js"></script>
<script type="text/javascript" src="js/jgestures/jgestures.min.js"></script>
<script type="text/javascript" src="js/code.js"></script>
<script type="text/javascript" src="js/mathjaxconf.js" defer></script>
<script type="text/javascript" src="MathJax/es5/tex-chtml.js" defer></script>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:500,900">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:500,900">
</head>
<body>
<div id="content" class="content">
<h1 class="title">ニューロシンボリック Classical Planning</h1>
<p>
\[
\def\ceil#1{\lceil #1 \rceil}
\def\floor#1{\lfloor #1 \rfloor}
\def\1{\mathbf{1}}
\def\0{\mathbf{0}}
\newcommand{\train}{\mathcal{D}}
\newcommand{\valid}{\mathcal{D_{\mathrm{valid}}}}
\newcommand{\test}{\mathcal{D_{\mathrm{test}}}}
\def\eps{{\epsilon}}
\def\ralpha{{\text{\alpha}}}
\def\rbeta{{\text{\beta}}}
\def\rchi{{\text{\chi}}}
\def\rdelta{{\text{\delta}}}
\def\reta{{\text{\eta}}}
\def\repsilon{{\text{\epsilon}}}
\def\rfoo{{\text{\foo}}}
\def\rgamma{{\text{\gamma}}}
\def\riota{{\text{\iota}}}
\def\rkappa{{\text{\kappa}}}
\def\rlambda{{\text{\lambda}}}
\def\rmu{{\text{\mu}}}
\def\rnu{{\text{\nu}}}
\def\romega{{\text{\omega}}}
\def\rpi{{\text{\pi}}}
\def\rrho{{\text{\rho}}}
\def\rsigma{{\text{\sigma}}}
\def\rtau{{\text{\tau}}}
\def\rtheta{{\text{\theta}}}
\def\rupsilon{{\text{\upsilon}}}
\def\rxi{{\text{\xi}}}
\def\rzeta{{\text{\zeta}}}
\def\ra{{\textnormal{a}}}
\def\rb{{\textnormal{b}}}
\def\rc{{\textnormal{c}}}
\def\rd{{\textnormal{d}}}
\def\re{{\textnormal{e}}}
\def\rf{{\textnormal{f}}}
\def\rg{{\textnormal{g}}}
\def\rh{{\textnormal{h}}}
\def\ri{{\textnormal{i}}}
\def\rj{{\textnormal{j}}}
\def\rk{{\textnormal{k}}}
\def\rl{{\textnormal{l}}}
\def\rn{{\textnormal{n}}}
\def\ro{{\textnormal{o}}}
\def\rp{{\textnormal{p}}}
\def\rq{{\textnormal{q}}}
\def\rr{{\textnormal{r}}}
\def\rs{{\textnormal{s}}}
\def\rt{{\textnormal{t}}}
\def\ru{{\textnormal{u}}}
\def\rv{{\textnormal{v}}}
\def\rw{{\textnormal{w}}}
\def\rx{{\textnormal{x}}}
\def\ry{{\textnormal{y}}}
\def\rz{{\textnormal{z}}}
\def\rA{{\textnormal{A}}}
\def\rB{{\textnormal{B}}}
\def\rC{{\textnormal{C}}}
\def\rD{{\textnormal{D}}}
\def\rE{{\textnormal{E}}}
\def\rF{{\textnormal{F}}}
\def\rG{{\textnormal{G}}}
\def\rH{{\textnormal{H}}}
\def\rI{{\textnormal{I}}}
\def\rJ{{\textnormal{J}}}
\def\rK{{\textnormal{K}}}
\def\rL{{\textnormal{L}}}
\def\rN{{\textnormal{N}}}
\def\rO{{\textnormal{O}}}
\def\rP{{\textnormal{P}}}
\def\rQ{{\textnormal{Q}}}
\def\rR{{\textnormal{R}}}
\def\rS{{\textnormal{S}}}
\def\rT{{\textnormal{T}}}
\def\rU{{\textnormal{U}}}
\def\rV{{\textnormal{V}}}
\def\rW{{\textnormal{W}}}
\def\rX{{\textnormal{X}}}
\def\rY{{\textnormal{Y}}}
\def\rZ{{\textnormal{Z}}}
\def\rvalpha{{\mathbf{\alpha}}}
\def\rvbeta{{\mathbf{\beta}}}
\def\rvchi{{\mathbf{\chi}}}
\def\rvdelta{{\mathbf{\delta}}}
\def\rveta{{\mathbf{\eta}}}
\def\rvepsilon{{\mathbf{\epsilon}}}
\def\rvfoo{{\mathbf{\foo}}}
\def\rvgamma{{\mathbf{\gamma}}}
\def\rviota{{\mathbf{\iota}}}
\def\rvkappa{{\mathbf{\kappa}}}
\def\rvlambda{{\mathbf{\lambda}}}
\def\rvmu{{\mathbf{\mu}}}
\def\rvnu{{\mathbf{\nu}}}
\def\rvomega{{\mathbf{\omega}}}
\def\rvpi{{\mathbf{\pi}}}
\def\rvrho{{\mathbf{\rho}}}
\def\rvsigma{{\mathbf{\sigma}}}
\def\rvtau{{\mathbf{\tau}}}
\def\rvtheta{{\mathbf{\theta}}}
\def\rvupsilon{{\mathbf{\upsilon}}}
\def\rvxi{{\mathbf{\xi}}}
\def\rvzeta{{\mathbf{\zeta}}}
\def\rva{{\mathbf{a}}}
\def\rvb{{\mathbf{b}}}
\def\rvc{{\mathbf{c}}}
\def\rvd{{\mathbf{d}}}
\def\rve{{\mathbf{e}}}
\def\rvf{{\mathbf{f}}}
\def\rvg{{\mathbf{g}}}
\def\rvh{{\mathbf{h}}}
\def\rvu{{\mathbf{i}}}
\def\rvj{{\mathbf{j}}}
\def\rvk{{\mathbf{k}}}
\def\rvl{{\mathbf{l}}}
\def\rvm{{\mathbf{m}}}
\def\rvn{{\mathbf{n}}}
\def\rvo{{\mathbf{o}}}
\def\rvp{{\mathbf{p}}}
\def\rvq{{\mathbf{q}}}
\def\rvr{{\mathbf{r}}}
\def\rvs{{\mathbf{s}}}
\def\rvt{{\mathbf{t}}}
\def\rvu{{\mathbf{u}}}
\def\rvv{{\mathbf{v}}}
\def\rvw{{\mathbf{w}}}
\def\rvx{{\mathbf{x}}}
\def\rvy{{\mathbf{y}}}
\def\rvz{{\mathbf{z}}}
\def\ervalpha{{\text{\alpha}}}
\def\ervbeta{{\text{\beta}}}
\def\ervchi{{\text{\chi}}}
\def\ervdelta{{\text{\delta}}}
\def\erveta{{\text{\eta}}}
\def\ervepsilon{{\text{\epsilon}}}
\def\ervfoo{{\text{\foo}}}
\def\ervgamma{{\text{\gamma}}}
\def\erviota{{\text{\iota}}}
\def\ervkappa{{\text{\kappa}}}
\def\ervlambda{{\text{\lambda}}}
\def\ervmu{{\text{\mu}}}
\def\ervnu{{\text{\nu}}}
\def\ervomega{{\text{\omega}}}
\def\ervpi{{\text{\pi}}}
\def\ervrho{{\text{\rho}}}
\def\ervsigma{{\text{\sigma}}}
\def\ervtau{{\text{\tau}}}
\def\ervtheta{{\text{\theta}}}
\def\ervupsilon{{\text{\upsilon}}}
\def\ervxi{{\text{\xi}}}
\def\ervzeta{{\text{\zeta}}}
\def\erva{{\textnormal{a}}}
\def\ervb{{\textnormal{b}}}
\def\ervc{{\textnormal{c}}}
\def\ervd{{\textnormal{d}}}
\def\erve{{\textnormal{e}}}
\def\ervf{{\textnormal{f}}}
\def\ervg{{\textnormal{g}}}
\def\ervh{{\textnormal{h}}}
\def\ervi{{\textnormal{i}}}
\def\ervj{{\textnormal{j}}}
\def\ervk{{\textnormal{k}}}
\def\ervl{{\textnormal{l}}}
\def\ervm{{\textnormal{m}}}
\def\ervn{{\textnormal{n}}}
\def\ervo{{\textnormal{o}}}
\def\ervp{{\textnormal{p}}}
\def\ervq{{\textnormal{q}}}
\def\ervr{{\textnormal{r}}}
\def\ervs{{\textnormal{s}}}
\def\ervt{{\textnormal{t}}}
\def\ervu{{\textnormal{u}}}
\def\ervv{{\textnormal{v}}}
\def\ervw{{\textnormal{w}}}
\def\ervx{{\textnormal{x}}}
\def\ervy{{\textnormal{y}}}
\def\ervz{{\textnormal{z}}}
\def\rmA{{\mathbf{A}}}
\def\rmB{{\mathbf{B}}}
\def\rmC{{\mathbf{C}}}
\def\rmD{{\mathbf{D}}}
\def\rmE{{\mathbf{E}}}
\def\rmF{{\mathbf{F}}}
\def\rmG{{\mathbf{G}}}
\def\rmH{{\mathbf{H}}}
\def\rmI{{\mathbf{I}}}
\def\rmJ{{\mathbf{J}}}
\def\rmK{{\mathbf{K}}}
\def\rmL{{\mathbf{L}}}
\def\rmM{{\mathbf{M}}}
\def\rmN{{\mathbf{N}}}
\def\rmO{{\mathbf{O}}}
\def\rmP{{\mathbf{P}}}
\def\rmQ{{\mathbf{Q}}}
\def\rmR{{\mathbf{R}}}
\def\rmS{{\mathbf{S}}}
\def\rmT{{\mathbf{T}}}
\def\rmU{{\mathbf{U}}}
\def\rmV{{\mathbf{V}}}
\def\rmW{{\mathbf{W}}}
\def\rmX{{\mathbf{X}}}
\def\rmY{{\mathbf{Y}}}
\def\rmZ{{\mathbf{Z}}}
\def\ermA{{\textnormal{A}}}
\def\ermB{{\textnormal{B}}}
\def\ermC{{\textnormal{C}}}
\def\ermD{{\textnormal{D}}}
\def\ermE{{\textnormal{E}}}
\def\ermF{{\textnormal{F}}}
\def\ermG{{\textnormal{G}}}
\def\ermH{{\textnormal{H}}}
\def\ermI{{\textnormal{I}}}
\def\ermJ{{\textnormal{J}}}
\def\ermK{{\textnormal{K}}}
\def\ermL{{\textnormal{L}}}
\def\ermM{{\textnormal{M}}}
\def\ermN{{\textnormal{N}}}
\def\ermO{{\textnormal{O}}}
\def\ermP{{\textnormal{P}}}
\def\ermQ{{\textnormal{Q}}}
\def\ermR{{\textnormal{R}}}
\def\ermS{{\textnormal{S}}}
\def\ermT{{\textnormal{T}}}
\def\ermU{{\textnormal{U}}}
\def\ermV{{\textnormal{V}}}
\def\ermW{{\textnormal{W}}}
\def\ermX{{\textnormal{X}}}
\def\ermY{{\textnormal{Y}}}
\def\ermZ{{\textnormal{Z}}}
\def\vzero{{\mathbf{0}}}
\def\vone{{\mathbf{1}}}
\def\valpha{{\mathbf{\alpha}}}
\def\vbeta{{\mathbf{\beta}}}
\def\vchi{{\mathbf{\chi}}}
\def\vdelta{{\mathbf{\delta}}}
\def\veta{{\mathbf{\eta}}}
\def\vepsilon{{\mathbf{\epsilon}}}
\def\vfoo{{\mathbf{\foo}}}
\def\vgamma{{\mathbf{\gamma}}}
\def\viota{{\mathbf{\iota}}}
\def\vkappa{{\mathbf{\kappa}}}
\def\vlambda{{\mathbf{\lambda}}}
\def\vmu{{\mathbf{\mu}}}
\def\vnu{{\mathbf{\nu}}}
\def\vomega{{\mathbf{\omega}}}
\def\vpi{{\mathbf{\pi}}}
\def\vrho{{\mathbf{\rho}}}
\def\vsigma{{\mathbf{\sigma}}}
\def\vtau{{\mathbf{\tau}}}
\def\vtheta{{\mathbf{\theta}}}
\def\vupsilon{{\mathbf{\upsilon}}}
\def\vxi{{\mathbf{\xi}}}
\def\vzeta{{\mathbf{\zeta}}}
\def\va{{\mathbf{a}}}
\def\vb{{\mathbf{b}}}
\def\vc{{\mathbf{c}}}
\def\vd{{\mathbf{d}}}
\def\ve{{\mathbf{e}}}
\def\vf{{\mathbf{f}}}
\def\vg{{\mathbf{g}}}
\def\vh{{\mathbf{h}}}
\def\vi{{\mathbf{i}}}
\def\vj{{\mathbf{j}}}
\def\vk{{\mathbf{k}}}
\def\vl{{\mathbf{l}}}
\def\vm{{\mathbf{m}}}
\def\vn{{\mathbf{n}}}
\def\vo{{\mathbf{o}}}
\def\vp{{\mathbf{p}}}
\def\vq{{\mathbf{q}}}
\def\vr{{\mathbf{r}}}
\def\vs{{\mathbf{s}}}
\def\vt{{\mathbf{t}}}
\def\vu{{\mathbf{u}}}
\def\vv{{\mathbf{v}}}
\def\vw{{\mathbf{w}}}
\def\vx{{\mathbf{x}}}
\def\vy{{\mathbf{y}}}
\def\vz{{\mathbf{z}}}
\def\evalpha{{{\alpha}}}
\def\evbeta{{{\beta}}}
\def\evchi{{{\chi}}}
\def\evdelta{{{\delta}}}
\def\eveta{{{\eta}}}
\def\evepsilon{{{\epsilon}}}
\def\evfoo{{{\foo}}}
\def\evgamma{{{\gamma}}}
\def\eviota{{{\iota}}}
\def\evkappa{{{\kappa}}}
\def\evlambda{{{\lambda}}}
\def\evmu{{{\mu}}}
\def\evnu{{{\nu}}}
\def\evomega{{{\omega}}}
\def\evpi{{{\pi}}}
\def\evrho{{{\rho}}}
\def\evsigma{{{\sigma}}}
\def\evtau{{{\tau}}}
\def\evtheta{{{\theta}}}
\def\evupsilon{{{\upsilon}}}
\def\evxi{{{\xi}}}
\def\evzeta{{{\zeta}}}
\def\eva{{a}}
\def\evb{{b}}
\def\evc{{c}}
\def\evd{{d}}
\def\eve{{e}}
\def\evf{{f}}
\def\evg{{g}}
\def\evh{{h}}
\def\evi{{i}}
\def\evj{{j}}
\def\evk{{k}}
\def\evl{{l}}
\def\evm{{m}}
\def\evn{{n}}
\def\evo{{o}}
\def\evp{{p}}
\def\evq{{q}}
\def\evr{{r}}
\def\evs{{s}}
\def\evt{{t}}
\def\evu{{u}}
\def\evv{{v}}
\def\evw{{w}}
\def\evx{{x}}
\def\evy{{y}}
\def\evz{{z}}
\def\mA{{\mathbf{A}}}
\def\mB{{\mathbf{B}}}
\def\mC{{\mathbf{C}}}
\def\mD{{\mathbf{D}}}
\def\mE{{\mathbf{E}}}
\def\mF{{\mathbf{F}}}
\def\mG{{\mathbf{G}}}
\def\mH{{\mathbf{H}}}
\def\mI{{\mathbf{I}}}
\def\mJ{{\mathbf{J}}}
\def\mK{{\mathbf{K}}}
\def\mL{{\mathbf{L}}}
\def\mM{{\mathbf{M}}}
\def\mN{{\mathbf{N}}}
\def\mO{{\mathbf{O}}}
\def\mP{{\mathbf{P}}}
\def\mQ{{\mathbf{Q}}}
\def\mR{{\mathbf{R}}}
\def\mS{{\mathbf{S}}}
\def\mT{{\mathbf{T}}}
\def\mU{{\mathbf{U}}}
\def\mV{{\mathbf{V}}}
\def\mW{{\mathbf{W}}}
\def\mX{{\mathbf{X}}}
\def\mY{{\mathbf{Y}}}
\def\mZ{{\mathbf{Z}}}
\def\mBeta{{\mathbf{\beta}}}
\def\mPhi{{\mathbf{\Phi}}}
\def\mLambda{{\mathbf{\Lambda}}}
\def\mSigma{{\mathbf{\Sigma}}}
\def\gA{{\mathcal{A}}}
\def\gB{{\mathcal{B}}}
\def\gC{{\mathcal{C}}}
\def\gD{{\mathcal{D}}}
\def\gE{{\mathcal{E}}}
\def\gF{{\mathcal{F}}}
\def\gG{{\mathcal{G}}}
\def\gH{{\mathcal{H}}}
\def\gI{{\mathcal{I}}}
\def\gJ{{\mathcal{J}}}
\def\gK{{\mathcal{K}}}
\def\gL{{\mathcal{L}}}
\def\gM{{\mathcal{M}}}
\def\gN{{\mathcal{N}}}
\def\gO{{\mathcal{O}}}
\def\gP{{\mathcal{P}}}
\def\gQ{{\mathcal{Q}}}
\def\gR{{\mathcal{R}}}
\def\gS{{\mathcal{S}}}
\def\gT{{\mathcal{T}}}
\def\gU{{\mathcal{U}}}
\def\gV{{\mathcal{V}}}
\def\gW{{\mathcal{W}}}
\def\gX{{\mathcal{X}}}
\def\gY{{\mathcal{Y}}}
\def\gZ{{\mathcal{Z}}}
\def\sA{{\mathbb{A}}}
\def\sB{{\mathbb{B}}}
\def\sC{{\mathbb{C}}}
\def\sD{{\mathbb{D}}}
\def\sF{{\mathbb{F}}}
\def\sG{{\mathbb{G}}}
\def\sH{{\mathbb{H}}}
\def\sI{{\mathbb{I}}}
\def\sJ{{\mathbb{J}}}
\def\sK{{\mathbb{K}}}
\def\sL{{\mathbb{L}}}
\def\sM{{\mathbb{M}}}
\def\sN{{\mathbb{N}}}
\def\sO{{\mathbb{O}}}
\def\sP{{\mathbb{P}}}
\def\sQ{{\mathbb{Q}}}
\def\sR{{\mathbb{R}}}
\def\sS{{\mathbb{S}}}
\def\sT{{\mathbb{T}}}
\def\sU{{\mathbb{U}}}
\def\sV{{\mathbb{V}}}
\def\sW{{\mathbb{W}}}
\def\sX{{\mathbb{X}}}
\def\sY{{\mathbb{Y}}}
\def\sZ{{\mathbb{Z}}}
\def\emLambda{{\Lambda}}
\def\emA{{A}}
\def\emB{{B}}
\def\emC{{C}}
\def\emD{{D}}
\def\emE{{E}}
\def\emF{{F}}
\def\emG{{G}}
\def\emH{{H}}
\def\emI{{I}}
\def\emJ{{J}}
\def\emK{{K}}
\def\emL{{L}}
\def\emM{{M}}
\def\emN{{N}}
\def\emO{{O}}
\def\emP{{P}}
\def\emQ{{Q}}
\def\emR{{R}}
\def\emS{{S}}
\def\emT{{T}}
\def\emU{{U}}
\def\emV{{V}}
\def\emW{{W}}
\def\emX{{X}}
\def\emY{{Y}}
\def\emZ{{Z}}
\def\emSigma{{\Sigma}}
\newcommand{\pdata}{p_{\mathrm{data}}}
\newcommand{\ptrain}{\hat{p}_{\mathrm{data}}}
\newcommand{\Ptrain}{\hat{P}_{\mathrm{data}}}
\newcommand{\pmodel}{p_{\mathrm{model}}}
\newcommand{\Pmodel}{P_{\mathrm{model}}}
\newcommand{\ptildemodel}{\tilde{p}_{\mathrm{model}}}
\newcommand{\pencode}{p_{\mathrm{encoder}}}
\newcommand{\pdecode}{p_{\mathrm{decoder}}}
\newcommand{\precons}{p_{\mathrm{reconstruct}}}
\def\A{{\mathcal{A}}}
\def\B{{\mathbb{B}}}
\def\C{{\mathcal{C}}}
\def\D{{\mathcal{D}}}
\def\E{{\mathbb{E}}}
\def\F{{\mathcal{F}}}
\def\G{{\mathcal{G}}}
\def\H{{\mathcal{H}}}
\def\I{{\mathcal{I}}}
\def\J{{\mathcal{J}}}
\def\K{{\mathcal{K}}}
\def\L{{\mathcal{L}}}
\def\M{{\mathcal{M}}}
\def\N{{\mathcal{N}}}
\def\O{{\mathcal{O}}}
\def\P{{\mathcal{P}}}
\def\Q{{\mathbb{Q}}}
\def\R{{\mathbb{R}}}
\def\S{{\mathcal{S}}}
\def\T{{\mathcal{T}}}
\def\U{{\mathcal{U}}}
\def\V{{\mathcal{V}}}
\def\W{{\mathcal{W}}}
\def\X{{\mathcal{X}}}
\def\Y{{\mathcal{Y}}}
\def\Z{{\mathbb{Z}}}
\def\ealpha{{\bar{\alpha}}}
\def\ebeta{{\bar{\beta}}}
\def\echi{{\bar{\chi}}}
\def\edelta{{\bar{\delta}}}
\def\eeta{{\bar{\eta}}}
\def\eepsilon{{\bar{\epsilon}}}
\def\efoo{{\bar{\foo}}}
\def\egamma{{\bar{\gamma}}}
\def\eiota{{\bar{\iota}}}
\def\ekappa{{\bar{\kappa}}}
\def\elambda{{\bar{\lambda}}}
\def\emu{{\bar{\mu}}}
\def\enu{{\bar{\nu}}}
\def\eomega{{\bar{\omega}}}
\def\epi{{\bar{\pi}}}
\def\erho{{\bar{\rho}}}
\def\esigma{{\bar{\sigma}}}
\def\etau{{\bar{\tau}}}
\def\etheta{{\bar{\theta}}}
\def\eupsilon{{\bar{\upsilon}}}
\def\exi{{\bar{\xi}}}
\def\ezeta{{\bar{\zeta}}}
\def\ea{{\bar{a}}}
\def\eb{{\bar{b}}}
\def\ec{{\bar{c}}}
\def\ed{{\bar{d}}}
\def\ee{{\bar{e}}}
\def\ef{{\bar{f}}}
\def\eg{{\bar{g}}}
\def\eh{{\bar{h}}}
\def\ei{{\bar{i}}}
\def\ej{{\bar{j}}}
\def\ek{{\bar{k}}}
\def\el{{\bar{l}}}
\def\en{{\bar{n}}}
\def\eo{{\bar{o}}}
\def\ep{{\bar{p}}}
\def\eq{{\bar{q}}}
\def\er{{\bar{r}}}
\def\es{{\bar{s}}}
\def\et{{\bar{t}}}
\def\eu{{\bar{u}}}
\def\ev{{\bar{v}}}
\def\ew{{\bar{w}}}
\def\ey{{\bar{y}}}
\def\ez{{\bar{z}}}
\newcommand{\emp}{\tilde{p}}
\newcommand{\lr}{\alpha}
\newcommand{\reg}{\lambda}
\newcommand{\rect}{\mathrm{rectifier}}
\newcommand{\softmax}{\mathrm{softmax}}
\newcommand{\sigmoid}{\mathrm{sigmoid}}
\newcommand{\softplus}{\zeta}
\newcommand{\KL}{D_{\mathrm{KL}}}
\newcommand{\Var}{\mathrm{Var}}
\newcommand{\standarderror}{\mathrm{SE}}
\newcommand{\Cov}{\mathrm{Cov}}
\newcommand{\normlzero}{L^0}
\newcommand{\normlone}{L^1}
\newcommand{\normltwo}{L^2}
\newcommand{\normlp}{L^p}
\newcommand{\normmax}{L^\infty}
\newcommand{\parents}{Pa} % See usage in notation.tex. Chosen to match Daphne's book.
\def\Mid{\mathrel{\|}}
\newcommand{\union}{\cup}
\newcommand{\intersection}{\cap}
\newcommand{\brackets}[1]{{\left&lt;#1\right&gt;}}
\newcommand{\braces}[1]{{\left\{#1\right\}}}
\newcommand{\parens}[1]{{\left(#1\right)}}
\newcommand{\bars}[1]{{\left|#1\right|}}
\newcommand{\then}{\therefore \qquad}
\newcommand{\from}{\leftarrow}
\newcommand{\then}{\Rightarrow}
\newcommand{\when}{\Leftarrow}
\newcommand{\iff}{\Leftrightarrow}
\def\qed{\hfill $\Box$}
\newcommand{\erf}{\mathsf{erf}}
\newcommand{\cerf}{\mathsf{cerf}}
\newcommand{\erfi}{\mathsf{erfi}}
\newcommand{\cerfi}{\mathsf{cerfi}}
\newcommand{\supp}{\mathsf{supp}} %support
\newcommand{\elbo}{\mathsf{elbo}}
\newcommand{\iid}{i.i.d.\xspace}
\newcommand{\bern}{\text{\small Bernoulli}}
\newcommand{\cat}{\mathbf{Cat}} %categorical
\newcommand{\gsdist}{\mathbf{GS}}
\newcommand{\dir}{\mathbf{Dir}} %dirichlet
\newcommand{\bin}{\mathbf{Bin}} %binomial
\newcommand{\invchi}{\mathrm{Inv}\chi^2} %scaled inverse chi^2
\newcommand{\pareto}{\mathrm{Pa}} %pareto
\newcommand{\gumbel}{\mathrm{Gumbel}} %pareto
\newcommand{\gp}{\mathrm{GP}} %generalized pareto
\newcommand{\lomax}{\mathrm{Lomax}}
\newcommand{\ipareto}{\mathrm{iPa}}
\newcommand{\power}{\mathrm{Pow}}
\newcommand{\logpower}{\mathrm{LogPow}}
\newcommand{\Exp}{\mathrm{Exp}}
\newcommand{\EVD}{\mathrm{EVD}}
\]
</p>
<div class="outline-text-1" id="org78b034c">
<div class="org-center">
<p>

</p>



<div class="larger" id="org70cf752">
<p>
Masataro Asai
</p>

<p>
(MIT-IBM Watson AI Lab, IBM Research, Cambridge)
</p>

</div>




<div id="org2b1f0cc" class="figure">
<p><img src="img/MIT-IBM.png" alt="MIT-IBM.png" />
</p>
</div>
</div>

<div class="org-center">
<p>
質問はZoomに書き込み
</p>
</div>

</div>

<div id="outline-container-org6adcfc4" class="outline-2">
<h2 id="org6adcfc4"><span class="section-number-2">1.</span> Part 1:</h2>
<div class="outline-text-2" id="text-1">
<div class="xlarge" id="org712dfee">
<div class="org-center">
<p>
記号接地と
</p>

<p>
グラフィカルモデル
</p>
</div>

</div>
</div>
</div>

<div id="outline-container-org2378f96" class="outline-2">
<h2 id="org2378f96"><span class="section-number-2">2.</span> 火星に取り残された! うわ やっべ どうしよう?</h2>
<div class="outline-text-2" id="text-2">

<div id="org4ee4198" class="figure">
<p><img src="img/mars/mars.png" alt="mars.png" />
</p>
</div>
</div>
</div>

<div id="outline-container-orge2633b5" class="outline-2">
<h2 id="orge2633b5"><span class="section-number-2">3.</span> どっちの「知性」がいいですか?</h2>
<div class="outline-text-2" id="text-3">
<div class="container-fluid" id="orgf38e9e3">
<div class="row-fluid" id="org6036fcf">
<div class="span3" id="org315a34f">
<p>

</p>


<div id="orgd590cda" class="figure">
<p><img src="img/mars/mars.png" alt="mars.png" />
</p>
</div>

</div>
<div class="span4" id="org9c1d226">
<div class="org-center">
<p>
<b>経験に基づく勘だけ</b> でどうにかなる?
</p>

<p>
"考えるな、感じろ" でうまく行きますか?
</p>


<div id="orgd7717fd" class="figure">
<p><img src="img/static/yoda.gif" alt="yoda.gif" />
</p>
</div>

<p>
<i>Reflex (反射) agent</i>
</p>
</div>

</div>
<div class="span5" id="org02a4844">
<ul class="org-ul">
<li><div class="org-center">
<p>
ちょっと <b>頭を使って</b> 臨機応変に対応しますか?
</p>


<div id="orgb176217" class="figure">
<p><img src="img/static/mars/yoda-hmph.gif" alt="yoda-hmph.gif" />
</p>
</div>

<p>
<span class="underline"><i>Deliberative (熟考) agent</i></span>
</p>
</div></li>
</ul>

</div>

</div>

</div>

<div class="org-center">
<ul class="org-ul">
<li><p>
→ <span class="underline">私がやりたいのは <b>熟考エージェント</b></span>
</p>

<p>
しかも、 <span class="underline">生のセンサー入力(画像)を直接使えるやつ</span>
</p></li>
</ul>
</div>
</div>
</div>

<div id="outline-container-org9fc12d9" class="outline-2">
<h2 id="org9fc12d9"><span class="section-number-2">4.</span> 古典プランナ (古典自動計画ソルバ): <br> <b>8パズルをミリ秒単位で解ける.</b></h2>
<div class="outline-text-2" id="text-4">
<p>
記号的探索・推論システムは爆速
</p>

<div class="container-fluid" id="org8528156">
<div class="row-fluid" id="orgc6b9ec5">
<div class="span2" id="org5fb8df1">
<p>

</p>

</div>
<div class="span4" id="org7a3cadf">

<div id="org81b589d" class="figure">
<p><img src="img/8puzzle-standard.png" alt="8puzzle-standard.png" />
</p>
</div>

</div>
<div class="span4" id="orgff80f62">

<div id="orgdc1fd91" class="figure">
<p><img src="img/8puzzle-standard-goal.png" alt="8puzzle-standard-goal.png" />
</p>
</div>

</div>
<div class="span2" id="org7561c4f">

<div id="org6014b05" class="figure">
<p><img src="img/static/8puzzle.gif" alt="8puzzle.gif" />
</p>
</div>

</div>

</div>

</div>

<p>
<i>でも PDDL があるときにしか 適用不可能.</i>
</p>

<div class="container-fluid" id="org55c4dc9">
<div class="row-fluid" id="orgf93765f">
<div class="span12" id="org92a984c">
<div class="org-src-container">
<pre class="src src-scheme">(<span style="color: #483d8b;">:action</span>       move-up ...
 <span style="color: #483d8b;">:precondition</span> (<span style="color: #a020f0;">and</span>      (empty ?x ?y-old) ...)
 <span style="color: #483d8b;">:effects</span>      (<span style="color: #a020f0;">and</span> (not (empty ?x ?y-old))...))
</pre>
</div>

</div>

</div>

</div>

<p>
PDDL : Planning Domain Description Language
</p>
</div>
</div>

<div id="outline-container-org06d99ca" class="outline-2">
<h2 id="org06d99ca"><span class="section-number-2">5.</span> 弱点: <b><i>画像ベース入力</i></b> になると適用不可能</h2>
<div class="outline-text-2" id="text-5">
<div class="container-fluid" id="org99fc740">
<div class="row-fluid" id="orgf42d434">
<div class="span8" id="orgc217d5c">

<div id="orgfcb3152" class="figure">
<p><img src="img/static/puzzle.jpg" alt="puzzle.jpg" />
</p>
</div>

</div>
<div class="span4" id="org20f0ca3">
<ul class="org-ul">
<li><div class="org-center">
<p>
<b>なぜなら</b>
</p>

<p>
<b>プランナは</b>
</p>

<p>
<b>実行するのに</b>
</p>

<div class="larger" id="org5712cba">
<p>
<b><i>PDDL</i></b>
</p>

<p>
<b><i>モデルが</i></b>
</p>

<p>
<b><i>必要</i>!</b>
</p>

</div>
</div></li>
</ul>

</div>

</div>

</div>

<ul class="org-ul">
<li><p>
<b>Latplan (AAAI18, ICAPS19, IJCAI20, JAIR 22)</b> はこの問題を解決
</p>

<p>
<b><i>画像に対する事前知識なし</i></b> (画像に対するアノテーションなど)
</p>

<p>
　 <b><i>人に由来するラベル・記号は一切なし</i></b> : "タイルが9つある", "動く"
</p></li>
</ul>
</div>
</div>

<div id="outline-container-orga7e071e" class="outline-2">
<h2 id="orga7e071e"><span class="section-number-2">6.</span> Latplan の目標: <b><i>知識獲得ボトルネックの解消</i></b></h2>
<div class="outline-text-2" id="text-6">
<div class="container-fluid" id="org536ff3f">
<div class="row-fluid" id="orgeb3c9c9">
<div class="span4" id="orgf562204">
<p>

</p>

<div class="alignright" id="orgd4023ea">
<p>
<b>状態遷移の観測データ</b>
</p>

</div>


<div id="org064fd91" class="figure">
<p><img src="img/overview/1.png" alt="1.png" />
</p>
</div>

</div>
<div class="span1" id="org3c6b284">
<p>

</p>






<p>
→
</p>

</div>
<div class="span7" id="orgc2e2355">
<div class="org-center">
<p>
<b>PDDL Model</b>
</p>
</div>
<div class="org-src-container">
<pre class="src src-scheme">(<span style="color: #483d8b;">:action</span>       move-up
 <span style="color: #483d8b;">:precondition</span>
 (<span style="color: #a020f0;">and</span>      (empty ?x ?y-old) ...)
 <span style="color: #483d8b;">:effects</span>
 (<span style="color: #a020f0;">and</span> (not (empty ?x ?y-old))...))
</pre>
</div>

</div>

</div>

<div class="row-fluid" id="org937940f">
<div class="span12" id="org8af012a">
<ul class="org-ul">
<li>Latplan が自動化すべき作業は <b>2つ</b> あり、これらは別のタスク:</li>
</ul>

</div>

</div>
<div class="row-fluid" id="orga8468cb">
<div class="span6" id="orgbc90a31">
<ul class="org-ul">
<li><p>
<b>1. 記号生成:</b>
</p>

<div class="org-center">
<div class="larger" id="orga6f5867">
<p>
<b><i>シンボル</i> = PDDL内で使われる語彙</b>
</p>

</div>
</div></li>

<li><div class="smaller" id="org843a9d1">
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">Types</th>
<th scope="col" class="org-left">Examples</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">オブジェクト</td>
<td class="org-left"><b>panel<sub>7</sub></b>, <b>x<sub>0</sub></b>, <b>y<sub>0</sub></b> &#x2026;</td>
</tr>

<tr>
<td class="org-left">述語</td>
<td class="org-left">(<b>empty</b> ?x ?y)</td>
</tr>

<tr>
<td class="org-left">命題</td>
<td class="org-left"><b>p<sub>28</sub></b> = (empty x<sub>0</sub> y<sub>0</sub>)</td>
</tr>

<tr>
<td class="org-left">アクション</td>
<td class="org-left">(<b>slide-up</b> panel<sub>7</sub> x<sub>0</sub> y<sub>1</sub>)</td>
</tr>
</tbody>
</table>

</div></li>
</ul>

</div>
<div class="span6" id="org1050e23">
<ul class="org-ul">
<li><p>
<b>2. アクションモデル獲得:</b>
</p>

<div class="org-center">
<div class="larger" id="org621fabc">
<p>
<b><i>状態遷移ルールを</i></b>
</p>

<p>
<b><i>シンボルを用いて</i></b>
</p>

<p>
<b><i>表現すること</i></b>
</p>

</div>
</div></li>

<li><div class="org-center">
<p>
<b>When</b> <i>Empty(x, y<sub>old</sub>) ∧ &#x2026;</i> ;
</p>

<p>
<b>Then</b> <i>¬Empty(x,y<sub>old</sub>) ∧</i> &#x2026;
</p>
</div></li>
</ul>

</div>

</div>

</div>
</div>
</div>

<div id="outline-container-org24a6643" class="outline-2">
<h2 id="org24a6643"><span class="section-number-2">7.</span> Latplan は PDDL を自動生成 (IJCAI20, JAIR22)</h2>
<div class="outline-text-2" id="text-7">

<div id="orgc6dea4f" class="figure">
<p><img src="img/15puzzle-with-pddl/2.png" alt="2.png" />
</p>
</div>

<p>

</p>

<p>

</p>

<p>

</p>

<p>

</p>
</div>

<div id="outline-container-org15db0a1" class="outline-3">
<h3 id="org15db0a1"><span class="section-number-3">7.1.</span> Latplan は PDDL を自動生成 (IJCAI20, JAIR22)</h3>
<div class="outline-text-3" id="text-7-1">

<div id="orgc347372" class="figure">
<p><img src="img/15puzzle-with-pddl/1.png" alt="1.png" />
</p>
</div>

<p>

</p>

<p>

</p>

<p>

</p>

<p>

</p>
</div>
</div>

<div id="outline-container-org4d6e943" class="outline-3">
<h3 id="org4d6e943"><span class="section-number-3">7.2.</span> Latplan は PDDL を自動生成 (IJCAI20, JAIR22)</h3>
<div class="outline-text-3" id="text-7-2">

<div id="orga14e709" class="figure">
<p><img src="img/15puzzle-with-pddl/0.png" alt="0.png" />
</p>
</div>

<div class="org-center">
<ul class="org-ul">
<li><p>
Latplan が生成・接地するシンボルは すべて <b>無名シンボル</b> (<code>gensym</code>)
</p>

<p>
<b>人間の使う 自然言語シンボル</b> は扱わない
</p></li>

<li><p>
自然言語シンボルへの接地は <b>寄生的</b> 記号接地(*) とよばれる
</p>

<p>
<b>理由:</b> 人間の作った世界の離散化に依存しているから (例: <b>虹🌈は7色?</b>)
</p>

<div class="note" id="orgaa05d1b">
<p>
(*) Taddeo, Mariarosaria, and Luciano Floridi. "Solving the symbol grounding problem: a critical review of fifteen years of research." Journal of Experimental &amp; Theoretical Artificial Intelligence 17.4 (2005): 419-445.
</p>

</div></li>
</ul>
</div>
</div>
</div>
</div>


<div id="outline-container-org2bf43fe" class="outline-2">
<h2 id="org2bf43fe"><span class="section-number-2">8.</span> Latplan が解けるパズル/プランニング問題の例</h2>
<div class="outline-text-2" id="text-8">

<div id="org163e9f0" class="figure">
<p><img src="img/static/experiment/init-goal.png" alt="init-goal.png" />
</p>
</div>

<p>
8-puzzle, 15-puzzle, Lights-Out, Twisted Lights-out, <b>Blocksworld</b>, Sokoban
</p>
</div>

<div id="outline-container-orged37a25" class="outline-3">
<h3 id="orged37a25"><span class="section-number-3">8.1.</span> 成功率 (1ドメインあたり40タスク)</h3>
<div class="outline-text-3" id="text-8-1">

<div id="orgfc9c408" class="figure">
<p><img src="img/success.png" alt="success.png" />
</p>
</div>
</div>
</div>

<div id="outline-container-org60de474" class="outline-3">
<h3 id="org60de474"><span class="section-number-3">8.2.</span> 成功例 / 失敗例</h3>
<div class="outline-text-3" id="text-8-2">

<div id="org1650576" class="figure">
<p><img src="img/static/experiment/blocks-example.png" alt="blocks-example.png" />
</p>
</div>
</div>
</div>
</div>

<div id="outline-container-org045f259" class="outline-2">
<h2 id="org045f259"><span class="section-number-2">9.</span> このシステムの肝: <b>生成モデリング</b> + <br> <span class="underline"><i>ちゃんと古典プランニングのことを勉強すること</i></span></h2>
<div class="outline-text-2" id="text-9">
<ul class="org-ul">
<li>Latplan は <b>PDDLと互換性のあるアクションモデルを画像から学習する</b>.</li>
<li><b>「PDDLと互換性がある」ってどういう意味 ?</b></li>
</ul>

<ul class="org-ul">
<li>アクション: $a=\text{Eat}(\text{pizza🍕})$</li>
<li>前提条件: $\text{pre}(a)=\lnot \text{full}() \land \text{have}(\text{pizza🍕})$ &#x2014; 空腹かつピザがある</li>
<li>効果: <b>削除効果:</b> $\text{del}(a)=\{\text{have}(\text{pizza🍕}) \}$ &#x2014; ピザはなくなって</li>
<li>効果: <b>追加効果:</b> $\text{add}(a)=\{\text{full}() \}$ &#x2014; 満腹になる</li>
</ul>

<ul class="org-ul">
<li><blockquote>
<p>
<span class="underline"><i>状態遷移ルール:</i></span> $z_{t+1} = (z_t \setminus \text{del}(a)\ )\ \cup\ \text{add}(a)$
</p>
</blockquote>

<p>
効果 $\text{del}(a), \text{add}(a)$ は <b>$z_t$ に依存しない</b>.
</p></li>

<li><p>
<b><i>よくある世界モデル</i></b> は <b>そこをわかってない！</b> (自動計画の人がいない)
</p>
<blockquote>
<p>
<b><i>よくある世界モデル:</i></b> $z_{t+1} = \text{なぞのニューラルネット}(z_t, a)$
</p>
</blockquote></li>

<li><div class="larger" id="orge88b9f1">
<div class="org-center">
<p>
PDDLに変換できない → <b><i>高速なソルバを使えない</i></b>
</p>
</div>

</div></li>
</ul>
</div>
</div>

<div id="outline-container-org78faf17" class="outline-2">
<h2 id="org78faf17"><span class="section-number-2">10.</span> 高速ソルバのためにPDDL記号モデルを学習 <br> →言語の制約を <b><i>NNモデルに埋め込まないといけない</i></b></h2>
<div class="outline-text-2" id="text-10">
<ul class="org-ul">
<li><b>PDDLでは、アクションの効果と状態 $z_t$ は独立している.</b></li>
</ul>

<div class="org-center">
<ul class="org-ul">
<li>→ $z_t$ と独立な変数 <b>e</b> を導入する必要あり。</li>

<li><p>

</p>


<div id="orgde44042" class="figure">
<p><img src="img/space-ae/graphical-model-csae.png" alt="graphical-model-csae.png" />
</p>
</div></li>
</ul>
</div>

<ul class="org-ul">
<li><p>
これを <b>離散的隠れ変数</b> (Gumbel-Softmax) + <b>変分学習</b> で訓練。
</p>

<p>
グラフィカルモデルが数学的根拠を与える
</p></li>
</ul>
</div>
</div>

<div id="outline-container-org1675cd8" class="outline-2">
<h2 id="org1675cd8"><span class="section-number-2">11.</span> 離散表現学習: Gumbel-Softmax VAE ほか</h2>
<div class="outline-text-2" id="text-11">

<div id="org85af0f5" class="figure">
<p><img src="img/sae/state-ae-before.png" alt="state-ae-before.png" />
</p>
</div>
</div>

<div id="outline-container-orgaa0fd2e" class="outline-3">
<h3 id="orgaa0fd2e"><span class="section-number-3">11.1.</span> 離散表現学習: Gumbel-Softmax VAE ほか</h3>
<div class="outline-text-3" id="text-11-1">

<div id="orgef8e297" class="figure">
<p><img src="img/sae/state-ae.png" alt="state-ae.png" />
</p>
</div>

<ul class="org-ul">
<li><p>
2017年ぐらい以降、多数の手法が考案されている
</p>

<p>
(REBAR, RELAX, VQVAE, SQVAE, &#x2026;)
</p>

<ul class="org-ul">
<li><div class="alignright" id="org61a3ba2">
<p>
ニューロシンボリックをするなら要チェック!
</p>

</div></li>
</ul></li>
</ul>
</div>
</div>
</div>

<div id="outline-container-org444e275" class="outline-2">
<h2 id="org444e275"><span class="section-number-2">12.</span> <i>シンボル</i> は一種類だけではない</h2>
<div class="outline-text-2" id="text-12">
<p>
<b><i>命題シンボル</i></b> (handempty, &#x2026;) vs. <span class="underline"><i>アクションシンボル</i></span> (pickup,&#x2026;).
</p>

<div class="container-fluid" id="orgd9c04b1">
<div class="row-fluid" id="orgcf638ac">
<div class="span4" id="org4097903">

<div id="org393fe60" class="figure">
<p><img src="img/space-ae/graphical-model-csae-only.png" alt="graphical-model-csae-only.png" />
</p>
</div>

</div>
<div class="span8" id="org975f0a0">
<div class="org-center">
<ul class="org-ul">
<li><div class="larger" id="org9ba9528">
<p>
これらは <b>別の名前空間に存在する</b>.
</p>

</div>

<p>

</p>

<p>
自然言語シンボルも同様:
</p>

<p>
　 I <b><i>like</i></b> an apple : 動詞
</p>

<p>
　 Thanks for the <b><i>like</i></b> on Facebook! : 名詞
</p>

<p>
Common Lisp (Lisp-2) vs. Scheme (Lisp-1)
</p></li>
</ul>
</div>

<div class="larger" id="orgc947fe0">
<div class="alignright" id="org7693801">
<ul class="org-ul">
<li><p>
→ <b>別の名前空間</b> にあるシンボルは
</p>

<p>
<b>別の言語制約が必要。</b>
</p></li>
</ul>

</div>

</div>

</div>

</div>

</div>
</div>
</div>

<div id="outline-container-org5d93a75" class="outline-2">
<h2 id="org5d93a75"><span class="section-number-2">13.</span> PDDL: 6つの名前空間, 6つのメカニズム</h2>
<div class="outline-text-2" id="text-13">

<div id="org30e82f9" class="figure">
<p><img src="img/namespace/1.png" alt="1.png" />
</p>
</div>

<p>

</p>

<p>

</p>

<p>

</p>

<p>

</p>
</div>

<div id="outline-container-orga1d5c35" class="outline-3">
<h3 id="orga1d5c35"><span class="section-number-3">13.1.</span> PDDL: 6つの名前空間, 6つのメカニズム</h3>
<div class="outline-text-3" id="text-13-1">

<div id="org663fa7f" class="figure">
<p><img src="img/namespace/2.png" alt="2.png" />
</p>
</div>

<p>

</p>

<p>

</p>

<p>

</p>

<p>

</p>
</div>
</div>

<div id="outline-container-orgb30424a" class="outline-3">
<h3 id="orgb30424a"><span class="section-number-3">13.2.</span> PDDL: 6つの名前空間, 6つのメカニズム</h3>
<div class="outline-text-3" id="text-13-2">

<div id="orgd4d8e1a" class="figure">
<p><img src="img/namespace/3.png" alt="3.png" />
</p>
</div>

<p>

</p>

<p>

</p>

<p>

</p>

<p>

</p>
</div>
</div>

<div id="outline-container-org54e1e2d" class="outline-3">
<h3 id="org54e1e2d"><span class="section-number-3">13.3.</span> PDDL: 6つの名前空間, 6つのメカニズム</h3>
<div class="outline-text-3" id="text-13-3">

<div id="orgbcff2ec" class="figure">
<p><img src="img/namespace/4.png" alt="4.png" />
</p>
</div>

<p>
<b>問題シンボル:</b> 「マリオのステージを表すシンボル」→ 別の状態空間を生成
</p>

<p>
　Stage 1-1, Stage 1-2, &#x2026;
</p>

<p>

</p>

<p>

</p>
</div>
</div>

<div id="outline-container-orgc753aab" class="outline-3">
<h3 id="orgc753aab"><span class="section-number-3">13.4.</span> PDDL: 6つの名前空間, 6つのメカニズム</h3>
<div class="outline-text-3" id="text-13-4">

<div id="org89cf27e" class="figure">
<p><img src="img/namespace/5.png" alt="5.png" />
</p>
</div>

<p>
<b>問題シンボル:</b> 「マリオのステージを表すシンボル」→ 別の状態空間を生成
</p>

<p>
　Stage 1-1, Stage 1-2, &#x2026;
</p>

<p>
<b>ドメインシンボル:</b> 「別のゲームを表すシンボル」 → 別のアクションを生成
</p>

<p>
　マリオ、ゼルダ、ドンキーコング、F-Zero &#x2026;
</p>
</div>
</div>

<div id="outline-container-org691bb98" class="outline-3">
<h3 id="org691bb98"><span class="section-number-3">13.5.</span> PDDL: 6つの名前空間, 6つのメカニズム</h3>
<div class="outline-text-3" id="text-13-5">

<div id="orge35864f" class="figure">
<p><img src="img/namespace/6.png" alt="6.png" />
</p>
</div>

<p>
<b>問題シンボル:</b> 「マリオのステージを表すシンボル」→ 別の状態空間を生成
</p>

<p>
　Stage 1-1, Stage 1-2, &#x2026;
</p>

<p>
<b>ドメインシンボル:</b> 「別のゲームを表すシンボル」 → 別のアクションを生成
</p>

<p>
　マリオ、ゼルダ、ドンキーコング、F-Zero &#x2026;
</p>
</div>
</div>
</div>


<div id="outline-container-orgfb0ff33" class="outline-2">
<h2 id="orgfb0ff33"><span class="section-number-2">14.</span> 実際 Latplan を述語論理に拡張可 (ICLR2021 workshop)</h2>
<div class="outline-text-2" id="text-14">
<p>
<b>Latplan/FOSAE++</b> : 画像内の異なるオブジェクトに使えるアクションを学習
</p>

<div class="container-fluid" id="orgaab06be">
<div class="row-fluid" id="org5400716">
<div class="span4" id="orgacede98">

<div id="org5521336" class="figure">
<p><img src="img/graphical-model-fosae++-nopatch2.png" alt="graphical-model-fosae++-nopatch2.png" />
</p>
</div>

</div>
<div class="span8" id="org3be6af6">

<div id="org44e370c" class="figure">
<p><img src="img/blocks-wide.png" alt="blocks-wide.png" />
</p>
</div>

</div>

</div>

</div>


<ul class="org-ul">
<li><b>追加制約:</b> Successor State Axiom (<b>非束縛変数の禁止</b> [Reiter, 1991])</li>

<li>アクション: $a=\text{Eat}(\text{pizza}🍕)$ : 引数 $\text{pizza}🍕$</li>
<li><div class="org-center">
<p>
<b>効果:</b> <b><i>発表(フロム, アーマードコアの新作)</i></b>
</p>
</div></li>
<li><div class="alignright" id="orgb21791f">
<p>
↑ $\text{pizza}🍕$ を使わないので禁止
</p>

</div></li>

<li><div class="larger" id="org1a1d02e">
<div class="org-center">
<p>
新たな制約が <b>述語シンボル</b> のグラウンディングを可能にした
</p>
</div>

</div></li>
</ul>
</div>
</div>


<div id="outline-container-org551a804" class="outline-2">
<h2 id="org551a804"><span class="section-number-2">15.</span> Extending the generative model (unpublished)</h2>
<div class="outline-text-2" id="text-15">
<div class="container-fluid" id="orga12431a">
<div class="row-fluid" id="org12e0cca">
<div class="span4" id="org1413ea3">
<div class="org-center">
<ul class="org-ul">
<li><p>
Lifted actions,
</p>

<p>
Parameters <b>x</b>
</p>


<div id="org9e99729" class="figure">
<p><img src="img/space-ae/graphical-model-fosae.png" alt="graphical-model-fosae.png" />
</p>
</div>

<p>
Predicates, too.
</p>

<p>
<b>Compatible with First Order Logic.</b>
</p></li>
</ul>
</div>

</div>
<div class="span4" id="org5df26fa">
<div class="org-center">
<ul class="org-ul">
<li><p>
Temporal actions,
</p>

<p>
Action durations <b>d</b>
</p>


<div id="orgcf4882d" class="figure">
<p><img src="img/space-ae/graphical-model-time.png" alt="graphical-model-time.png" />
</p>
</div>

<p>
<b>Compatible with LTL.</b>
</p></li>
</ul>
</div>

</div>
<div class="span4" id="org7729659">
<div class="org-center">
<ul class="org-ul">
<li><p>
Domain symbol <b>D</b>,
</p>

<p>
Problem symbol <b>P</b>
</p>


<div id="orgfbe7952" class="figure">
<p><img src="img/space-ae/graphical-model-domain.png" alt="graphical-model-domain.png" />
</p>
</div>

<p>
Allows mixed-domain training?
</p></li>
</ul>
</div>

</div>

</div>

</div>
</div>
</div>



<div id="outline-container-orgf0d3468" class="outline-2">
<h2 id="orgf0d3468"><span class="section-number-2">16.</span> Part 1: Conclusion</h2>
<div class="outline-text-2" id="text-16">
<div class="container-fluid" id="org0712626">
<div class="row-fluid" id="orgc6278c5">
<div class="span7" id="orgc91febe">
<div class="org-center">
<ul class="org-ul">
<li><p>
<b>Goal: 理性的な実世界エージェント</b>
</p>


<div id="org8a77b8d" class="figure">
<p><img src="img/static/mars/yoda-hmph.gif" alt="yoda-hmph.gif" />
</p>
</div></li>
</ul>
</div>

</div>
<div class="span5" id="orgc4e15ae">
<div class="org-center">
<ul class="org-ul">
<li><p>
<b>Latplan</b> で記号接地
</p>


<div id="org3a28296" class="figure">
<p><img src="img/static/puzzle.jpg" alt="puzzle.jpg" />
</p>
</div></li>
</ul>
</div>

</div>

</div>
<div class="row-fluid" id="org3857a41">
<div class="span7" id="org56c3d9a">
<div class="org-center">
<ul class="org-ul">
<li><p>
異なるシンボルは  <b>別々の制約が必要</b>
</p>


<div id="orge54be9f" class="figure">
<p><img src="img/namespace/6.png" alt="6.png" />
</p>
</div></li>
</ul>
</div>

</div>
<div class="span5" id="org5047f34">
<div class="org-center">
<ul class="org-ul">
<li><p>
生成モデルによって
</p>

<p>
<b>制約を精緻に記述可能</b>
</p>


<div id="org6bdddcd" class="figure">
<p><img src="img/space-ae/graphical-model-csae.png" alt="graphical-model-csae.png" />
</p>
</div></li>
</ul>
</div>

</div>

</div>

</div>

<ul class="org-ul">
<li>記号接地するなら <b>対象言語を <i>ちゃんと</i> 理解して <i>正しく</i> モデル化しよう!</b></li>
</ul>


<div class="org-center">
<p>
質問: 2つまで
</p>
</div>
</div>
</div>

<div id="outline-container-org1a1e116" class="outline-2">
<h2 id="org1a1e116"><span class="section-number-2">17.</span> Part 2:</h2>
<div class="outline-text-2" id="text-17">
<div class="xlarge" id="orgb0ae689">
<p>
理性的な実世界エージェントの
</p>
<div class="org-center">
<p>
<b><i>アーキテクチャ</i></b>
</p>
</div>
<div class="alignright" id="org0c732f2">
<p>
を考える
</p>

</div>

</div>

<div class="alignright" id="org91af635">
<ul class="org-ul">
<li>→ <b>表現学習以外</b> の プランニング+機械学習</li>
</ul>

</div>
</div>
</div>


<div id="outline-container-org02c92cd" class="outline-2">
<h2 id="org02c92cd"><span class="section-number-2">18.</span> 理性的な実世界エージェントのアーキテクチャ</h2>
<div class="outline-text-2" id="text-18">
<div class="container-fluid" id="org4093e30">
<div class="row-fluid" id="org5a78d03">
<div class="span3" id="orgff9467b">

<div id="org2112dde" class="figure">
<p><img src="img/static/mars/yoda-hmph.gif" alt="yoda-hmph.gif" />
</p>
</div>

</div>
<div class="span9" id="org6ad5780">

<div id="org23d37a7" class="figure">
<p><img src="img/nesyarch/6.png" alt="6.png" />
</p>
</div>

</div>

</div>

</div>
</div>

<div id="outline-container-org436e303" class="outline-3">
<h3 id="org436e303"><span class="section-number-3">18.1.</span> 理性的な実世界エージェントのアーキテクチャ</h3>
<div class="outline-text-3" id="text-18-1">
<div class="container-fluid" id="org990e044">
<div class="row-fluid" id="org283db41">
<div class="span3" id="org40d53b3">

<div id="orgaa688b9" class="figure">
<p><img src="img/static/mars/yoda-hmph.gif" alt="yoda-hmph.gif" />
</p>
</div>

</div>
<div class="span9" id="org122b88a">

<div id="org54525b6" class="figure">
<p><img src="img/nesyarch/5.png" alt="5.png" />
</p>
</div>

</div>

</div>

</div>
</div>
</div>

<div id="outline-container-org9540883" class="outline-3">
<h3 id="org9540883"><span class="section-number-3">18.2.</span> 理性的な実世界エージェントのアーキテクチャ</h3>
<div class="outline-text-3" id="text-18-2">
<div class="container-fluid" id="org748eacc">
<div class="row-fluid" id="org89d09a4">
<div class="span3" id="orgab2b352">

<div id="org41ebdbf" class="figure">
<p><img src="img/static/mars/yoda-hmph.gif" alt="yoda-hmph.gif" />
</p>
</div>

</div>
<div class="span9" id="org160ff0c">

<div id="orga204f64" class="figure">
<p><img src="img/nesyarch/4.png" alt="4.png" />
</p>
</div>

</div>

</div>

</div>
</div>
</div>

<div id="outline-container-org832fbed" class="outline-3">
<h3 id="org832fbed"><span class="section-number-3">18.3.</span> 理性的な実世界エージェントのアーキテクチャ</h3>
<div class="outline-text-3" id="text-18-3">
<div class="container-fluid" id="orgfececb9">
<div class="row-fluid" id="org430fdc9">
<div class="span3" id="orgcc5cebf">

<div id="org916e2e3" class="figure">
<p><img src="img/static/mars/yoda-hmph.gif" alt="yoda-hmph.gif" />
</p>
</div>

</div>
<div class="span9" id="orgf5534de">

<div id="orgada51eb" class="figure">
<p><img src="img/nesyarch/3.png" alt="3.png" />
</p>
</div>

</div>

</div>

</div>
</div>
</div>

<div id="outline-container-org82e72f4" class="outline-3">
<h3 id="org82e72f4"><span class="section-number-3">18.4.</span> 理性的な実世界エージェントのアーキテクチャ</h3>
<div class="outline-text-3" id="text-18-4">
<div class="container-fluid" id="orgce2e0d4">
<div class="row-fluid" id="orge685600">
<div class="span3" id="org7c4097a">

<div id="org38dce1a" class="figure">
<p><img src="img/static/mars/yoda-hmph.gif" alt="yoda-hmph.gif" />
</p>
</div>

</div>
<div class="span9" id="org8c90a33">

<div id="org9793d1f" class="figure">
<p><img src="img/nesyarch/2.png" alt="2.png" />
</p>
</div>

</div>

</div>

</div>
</div>
</div>

<div id="outline-container-orgefe9179" class="outline-3">
<h3 id="orgefe9179"><span class="section-number-3">18.5.</span> 理性的な実世界エージェントのアーキテクチャ</h3>
<div class="outline-text-3" id="text-18-5">
<div class="container-fluid" id="org68179d6">
<div class="row-fluid" id="org018ab83">
<div class="span3" id="orgd9da2cc">

<div id="org2fb1578" class="figure">
<p><img src="img/static/mars/yoda-hmph.gif" alt="yoda-hmph.gif" />
</p>
</div>

</div>
<div class="span9" id="orga66b0ed">

<div id="orgbd357c3" class="figure">
<p><img src="img/nesyarch/1.png" alt="1.png" />
</p>
</div>

</div>

</div>

</div>
</div>
</div>

<div id="outline-container-orgac872df" class="outline-3">
<h3 id="orgac872df"><span class="section-number-3">18.6.</span> 理性的な実世界エージェントのアーキテクチャ</h3>
<div class="outline-text-3" id="text-18-6">
<div class="container-fluid" id="org3cde2bf">
<div class="row-fluid" id="orgdc1f7a8">
<div class="span3" id="org8ab51ef">

<div id="orge7a8b51" class="figure">
<p><img src="img/static/mars/yoda-hmph.gif" alt="yoda-hmph.gif" />
</p>
</div>

</div>
<div class="span9" id="orgd7f96b5">

<div id="orgb4e4216" class="figure">
<p><img src="img/nesyarch/0.png" alt="0.png" />
</p>
</div>

</div>

</div>

</div>
</div>
</div>

<div id="outline-container-org42ca2ba" class="outline-3">
<h3 id="org42ca2ba"><span class="section-number-3">18.7.</span> 理性的な実世界エージェントのアーキテクチャ</h3>
<div class="outline-text-3" id="text-18-7">
<div class="container-fluid" id="org32be4a9">
<div class="row-fluid" id="org5dd42bf">
<div class="span3" id="orga5eddde">

<div id="org38651fd" class="figure">
<p><img src="img/static/mars/yoda-hmph.gif" alt="yoda-hmph.gif" />
</p>
</div>

</div>
<div class="span9" id="orgf663bc8">

<div id="org1404938" class="figure">
<p><img src="img/nesyarch/0a.png" alt="0a.png" />
</p>
</div>

</div>

</div>

</div>
</div>
</div>
</div>

<div id="outline-container-org870dbdd" class="outline-2">
<h2 id="org870dbdd"><span class="section-number-2">19.</span> 探索ヒューリスティクスの学習:</h2>
<div class="outline-text-2" id="text-19">
<div class="container-fluid" id="org74a6cc6">
<div class="row-fluid" id="org20c6a28">
<div class="span6" id="org9f11931">
<div class="xlarge" id="org94beb63">
<div class="org-center">
<p>
RL
</p>

<p>
(ICAPS 2022)
</p>
</div>

</div>

</div>
<div class="span6" id="org4d94434">
<div class="xlarge" id="org5544a71">
<div class="org-center">
<p>
SL
</p>

<p>
(IJCAI 2024)
</p>
</div>

</div>

</div>

</div>

</div>
</div>
</div>

<div id="outline-container-orgac80614" class="outline-2">
<h2 id="orgac80614"><span class="section-number-2">20.</span> ICAPS22</h2>
<div class="outline-text-2" id="text-20">

<div id="org73c7979" class="figure">
<p><img src="img/pddlrl/title.png" alt="title.png" />
</p>
</div>
</div>
</div>

<div id="outline-container-org21a5ea3" class="outline-2">
<h2 id="org21a5ea3"><span class="section-number-2">21.</span> Value function learning</h2>
<div class="outline-text-2" id="text-21">
<p>
SGD Loss function:
</p>

<p>
\[
\frac{1}{|B|}\sum_{s\in B} \frac{1}{2}\left| V(s) - \mathbb{E}_{a\in A} [Q(a, s)] \right|^2
\]
</p>

<p>
$B$: batches in the experience replay
</p>

<div class="larger" id="org3dc65ab">
<p>
Research Questions:
</p>
<div class="org-center">
<ul class="org-ul">
<li><b>Q: RLだけで 古典プランニングを解けるか?</b> (A: <b>不可</b>)</li>

<li><b>Q: RLだけで プランニングを高速化できるか?</b> (A: <b>不可</b>)</li>

<li><b>Q: プランニングの道具と適切に組み合わせれば?</b> <b><i>(A: 可)</i></b></li>
</ul>
</div>
<div class="alignright" id="org975eaab">
<ul class="org-ul">
<li>Lessons learned: <b>古典プランニングを甘く見るな</b></li>
</ul>

</div>

</div>
</div>
</div>


<div id="outline-container-org9a4c756" class="outline-2">
<h2 id="org9a4c756"><span class="section-number-2">22.</span> Why Classical Plannning is difficult for RL?</h2>
<div class="outline-text-2" id="text-22">
<p>
Rewards in Classical Planning:
</p>

<div class="org-center">
<div class="larger" id="org1c45bab">
<ul class="org-ul">
<li><p>
$r(s,a,s') = \left\{\begin{array}{ll} 1 &amp; \text{if}\ s' \ \text{is a goal}, \\ 0 &amp; \text{otherwise}. \end{array}\right.$
</p>

<p>
<b>This is extremely sparse.</b>
</p></li>
</ul>

</div>
</div>

<ul class="org-ul">
<li><b><i>Any non-goal states</i></b> are <b>equally <i>worthless</i></b>

<ul class="org-ul">
<li><b>No guidance</b> for RL until a goal,</li>

<li>which is <b>difficult to find</b> in the first place!</li>
</ul></li>
</ul>
</div>
</div>

<div id="outline-container-org277d624" class="outline-2">
<h2 id="org277d624"><span class="section-number-2">23.</span> Potential-Based <b><i>Reward Shaping</i></b> (PBRS) <br> for Sparse Rewards</h2>
<div class="outline-text-2" id="text-23">
<p>
Given a <b>potential function</b> $\phi(s)$, <b><i>redefine rewards</i></b> as:
</p>

\begin{align}
\hat{r}(s, a, s') &amp;= r(s, a, s') + \gamma \phi(s') - \phi(s). \label{eq:shaping1}
\end{align}

<ul class="org-ul">
<li><p>
<b><i>Important:</i></b> PBRS <b>preserves</b> the optimal value function
</p>

  \begin{align}
  V^*_\gamma(s) &amp;= \hat{V}^*_\gamma(s) + \phi(s). \label{eq:shaping2}
  \end{align}

<div class="alignright" id="orgc7bba01">
<div class="larger" id="orgdc45599">
<p>
= <b>learning the residual from $\phi(s)$</b>
</p>

</div>

</div></li>
</ul>

<div class="note" id="org0a5de1f">
<p>
Ng, Harada, Russell. "Policy invariance under reward transformations: Theory and application to reward shaping." ICML. Vol. 99. 1999.
</p>

</div>
</div>
</div>

<div id="outline-container-org0f0b5e8" class="outline-2">
<h2 id="org0f0b5e8"><span class="section-number-2">24.</span> Heuristic Function $h(s)$ in classical planning</h2>
<div class="outline-text-2" id="text-24">
<ul class="org-ul">
<li><b>Distance estimate</b>
<ul class="org-ul">
<li>$h(s)=5 \quad \longleftrightarrow \quad s - s_1 - s_2 - s_3 - s_4 - \text{goal}$ (おおよそ)</li>
<li><p>
Many implementations: $h^{\text{add}}$, $h^{\text{FF}}$, $h^{\text{CEA}}$, &#x2026;
</p>

<div class="smaller" id="orgd25aa7a">
<p>
(Bonet&amp;Geffner 01, Hoffmann 01, Helmert 08) もっと新しいのもある
</p>

</div></li>
</ul></li>
</ul>

<div class="xlarge" id="orgea351e5">
<ul class="org-ul">
<li><b>Heuristics satisfies the PBRS requirements</b></li>

<li><div class="alignright" id="orgc72a9e2">
<p>
<b><i>Let's use $h(s)$ for PBRS!</i></b>
</p>

</div></li>
</ul>

</div>
</div>
</div>

<div id="outline-container-org384b7a4" class="outline-2">
<h2 id="org384b7a4"><span class="section-number-2">25.</span> Issue 1: <b><i>Discounting</i></b></h2>
<div class="outline-text-2" id="text-25">
<div class="larger" id="org5ef453d">
<p>
<b>RL : <i>discounted rewards</i></b> ↔ <b>Planning :</b> <span class="underline"><i>undiscounted costs</i></span>
</p>

</div>

<p>

</p>

<p>
Our solution:
</p>

<ul class="org-ul">
<li><b>Training</b> : Convert $h(s)\rightarrow h_{\gamma}(s)$ : <b><i>discounting</i></b> $h(s)$ for PBRS</li>

<li>\begin{align}
  \phi(s) &amp;= h_\gamma(s) = \sum_{t=1}^{h(s)} \gamma^t\cdot 1 = \dfrac{1 - \gamma^{h(s)}}{1 - \gamma}.
  \end{align}</li>
</ul>


<ul class="org-ul">
<li><b>Planning</b> : Convert $V_{\gamma}(s)\rightarrow V(s)$ : <span class="underline"><i>undiscounting</i></span> a learned $V_{\gamma}(s)$</li>

<li>\begin{align}
  V_\gamma(s) = \dfrac{1 - \gamma^{V(s)}}{1 - \gamma}
  &amp;\Leftrightarrow
  V(s) = \log_\gamma (1 - (1 - \gamma)V_\gamma(s)).
  \end{align}</li>
</ul>
</div>
</div>

<div id="outline-container-orgea40c06" class="outline-2">
<h2 id="orgea40c06"><span class="section-number-2">26.</span> Issue 2: Handling <b><i>First-Order Logic Input</i></b></h2>
<div class="outline-text-2" id="text-26">
<p>
Our solution: <b>Neural Logic Machine (NLM)</b> [Dong et. al. ICLR 2019]
</p>


<div id="orgcc2e0f3" class="figure">
<p><img src="img/pddlrl/nlm6.png" alt="nlm6.png" />
</p>
</div>
</div>

<div id="outline-container-orgf512c57" class="outline-3">
<h3 id="orgf512c57"><span class="section-number-3">26.1.</span> Issue 2: Handling <b><i>First-Order Logic Input</i></b></h3>
<div class="outline-text-3" id="text-26-1">
<p>
Our solution: <b>Neural Logic Machine (NLM)</b> [Dong et. al. ICLR 2019]
</p>


<div id="org15f2e05" class="figure">
<p><img src="img/pddlrl/nlm5.png" alt="nlm5.png" />
</p>
</div>
</div>
</div>

<div id="outline-container-org400856a" class="outline-3">
<h3 id="org400856a"><span class="section-number-3">26.2.</span> Issue 2: Handling <b><i>First-Order Logic Input</i></b></h3>
<div class="outline-text-3" id="text-26-2">
<p>
Our solution: <b>Neural Logic Machine (NLM)</b> [Dong et. al. ICLR 2019]
</p>


<div id="org295ab10" class="figure">
<p><img src="img/pddlrl/nlm4.png" alt="nlm4.png" />
</p>
</div>
</div>
</div>

<div id="outline-container-orgdeda929" class="outline-3">
<h3 id="orgdeda929"><span class="section-number-3">26.3.</span> Issue 2: Handling <b><i>First-Order Logic Input</i></b></h3>
<div class="outline-text-3" id="text-26-3">
<p>
Our solution: <b>Neural Logic Machine (NLM)</b> [Dong et. al. ICLR 2019]
</p>


<div id="orgdec75c2" class="figure">
<p><img src="img/pddlrl/nlm3.png" alt="nlm3.png" />
</p>
</div>
</div>
</div>

<div id="outline-container-orgcc219b5" class="outline-3">
<h3 id="orgcc219b5"><span class="section-number-3">26.4.</span> Issue 2: Handling <b><i>First-Order Logic Input</i></b></h3>
<div class="outline-text-3" id="text-26-4">
<p>
Our solution: <b>Neural Logic Machine (NLM)</b> [Dong et. al. ICLR 2019]
</p>


<div id="org0c39ac7" class="figure">
<p><img src="img/pddlrl/nlm2.png" alt="nlm2.png" />
</p>
</div>
</div>
</div>

<div id="outline-container-org891a308" class="outline-3">
<h3 id="org891a308"><span class="section-number-3">26.5.</span> Issue 2: Handling <b><i>First-Order Logic Input</i></b></h3>
<div class="outline-text-3" id="text-26-5">
<p>
Our solution: <b>Neural Logic Machine (NLM)</b> [Dong et. al. ICLR 2019]
</p>


<div id="org1e1df1c" class="figure">
<p><img src="img/pddlrl/nlm1.png" alt="nlm1.png" />
</p>
</div>
</div>
</div>

<div id="outline-container-org44588b2" class="outline-3">
<h3 id="org44588b2"><span class="section-number-3">26.6.</span> Issue 2: Handling <b><i>First-Order Logic Input</i></b></h3>
<div class="outline-text-3" id="text-26-6">
<p>
Our solution: <b>Neural Logic Machine (NLM)</b> [Dong et. al. ICLR 2019]
</p>


<div id="org40db8f9" class="figure">
<p><img src="img/pddlrl/nlm.png" alt="nlm.png" />
</p>
</div>

<ul class="org-ul">
<li><b>Size</b> &amp; <b>Permutation invariant</b> to FOL binary inputs</li>

<li><b>Quite useful for various FOL tasks</b>
<ul class="org-ul">
<li>ILP [Dong et. al. ICLR 2019]</li>
<li>Regression (our work)</li>
</ul></li>
</ul>
</div>
</div>
</div>

<div id="outline-container-orgb9a9951" class="outline-2">
<h2 id="orgb9a9951"><span class="section-number-2">27.</span> Results</h2>
<div class="outline-text-2" id="text-27">
<p>
Skipped
</p>
</div>
</div>

<div id="outline-container-org9806644" class="outline-2">
<h2 id="org9806644"><span class="section-number-2">28.</span> ICAPS 2022 : Conclusion</h2>
<div class="outline-text-2" id="text-28">
<div class="org-center">
<div class="container-fluid" id="org491a76a">
<div class="row-fluid" id="org7108965">
<div class="span6" id="org57a3867">
<ul class="org-ul">
<li><p>
<b>Sparse Rewards</b>
</p>

<div class="smaller" id="org7431cd2">
<p>
$r(s) = \left\{\begin{array}{ll} 1 &amp; \text{if}\ s \ \text{is a goal}, \\ 0 &amp; \text{otherwise}. \end{array}\right.$
</p>

<p>
ゴールにたどり着くのが
</p>

<p>
とても難しい
</p>

</div></li>
</ul>

</div>
<div class="span6" id="orgd111a75">
<ul class="org-ul">
<li><p>
<b>Potential-Based</b>
</p>

<p>
<b>Reward Shaping</b>
</p>

<p>
$V^*_\gamma(s) = \hat{V}^*_\gamma(s) + \phi(s)$
</p>

<div class="smaller" id="org5d72efa">
<p>
$\phi(s)=$ 距離の見積もり $h(s)$
</p>

<p>
Sparse Reward を解決
</p>

</div></li>
</ul>

</div>

</div>
<div class="row-fluid" id="org149dfa5">
<div class="span6" id="org87424be">
<ul class="org-ul">
<li><p>
<b>Discounting</b>
</p>

<p>
$h_\gamma(s)  = \dfrac{1 - \gamma^{h(s)}}{1 - \gamma}$
</p>

<p>
$V(s) = \log_\gamma (1 - (1 - \gamma)V_\gamma(s))$
</p>

<div class="smaller" id="org135f16c">
<p>
これがないと
</p>

<p>
$h(s)=\infty$ のとき死ぬ
</p>

</div></li>
</ul>

</div>
<div class="span6" id="org75b8407">
<ul class="org-ul">
<li><p>
<b>First-Order Logic Input</b>
</p>


<div id="org6733e61" class="figure">
<p><img src="img/pddlrl/nlm.png" alt="nlm.png" />
</p>
</div>

<div class="smaller" id="orgb80b51c">
<p>
異なるサイズの問題に汎化
</p>

</div></li>
</ul>

</div>

</div>

</div>

<div class="smaller" id="org8dbb911">
<ul class="org-ul">
<li><p>
<b>Q: RLだけで 古典プランニングを解けるか?</b> (A: <b>不可</b>)
</p>

<p>
<b>Q: RLだけで プランニングを高速化できるか?</b> (A: <b>不可</b>)
</p>

<p>
<b>Q: プランニングの道具と適切に組み合わせれば?</b> <b><i>(A: 可)</i></b>
</p>

<p>
Lessons learned: <b><i>古典プランニングを甘く見るな</i></b>
</p></li>
</ul>

</div>
</div>
</div>
</div>


<div id="outline-container-org732d00c" class="outline-2">
<h2 id="org732d00c"><span class="section-number-2">29.</span> IJCAI24</h2>
<div class="outline-text-2" id="text-29">

<div id="org8486da2" class="figure">
<p><img src="img/truncated-gaussian/title.png" alt="title.png" />
</p>
</div>



<div class="xlarge" id="orgab721f9">
<div class="org-center">
<p>
RL 嫌いなんで &#x2026; 教師あり学習!
</p>
</div>

</div>
</div>
</div>

<div id="outline-container-orgf07b1a3" class="outline-2">
<h2 id="orgf07b1a3"><span class="section-number-2">30.</span> Task: Learn the shortest path cost</h2>
<div class="outline-text-2" id="text-30">

<div id="org73e97c3" class="figure">
<p><img src="img/truncated-gaussian/1b.png" alt="1b.png" />
</p>
</div>
</div>

<div id="outline-container-org86b9a91" class="outline-3">
<h3 id="org86b9a91"><span class="section-number-3">30.1.</span> Task: Learn the shortest path cost</h3>
<div class="outline-text-3" id="text-30-1">

<div id="org655d574" class="figure">
<p><img src="img/truncated-gaussian/1a.png" alt="1a.png" />
</p>
</div>
</div>
</div>

<div id="outline-container-orgdea30e1" class="outline-3">
<h3 id="orgdea30e1"><span class="section-number-3">30.2.</span> Task: Learn the shortest path cost</h3>
<div class="outline-text-3" id="text-30-2">

<div id="org9136241" class="figure">
<p><img src="img/truncated-gaussian/1.png" alt="1.png" />
</p>
</div>

<div class="larger" id="org5cf387f">
<div class="org-center">
<ul class="org-ul">
<li><b>Q: Can we exploit the <i>admissibility</i> of heuristics</b> in training?</li>
</ul>
</div>

</div>
</div>
</div>
</div>

<div id="outline-container-org6c7184a" class="outline-2">
<h2 id="org6c7184a"><span class="section-number-2">31.</span> Stop using (Mean) Square Errors!</h2>
<div class="outline-text-2" id="text-31">

<div id="org4515d1e" class="figure">
<p><img src="img/truncated-gaussian/2j.png" alt="2j.png" />
</p>
</div>
</div>

<div id="outline-container-orgae12995" class="outline-3">
<h3 id="orgae12995"><span class="section-number-3">31.1.</span> Stop using (Mean) Square Errors!</h3>
<div class="outline-text-3" id="text-31-1">

<div id="orgec9da63" class="figure">
<p><img src="img/truncated-gaussian/2i.png" alt="2i.png" />
</p>
</div>
</div>
</div>

<div id="outline-container-org92a1d4b" class="outline-3">
<h3 id="org92a1d4b"><span class="section-number-3">31.2.</span> Stop using (Mean) Square Errors!</h3>
<div class="outline-text-3" id="text-31-2">

<div id="orgfe75aa6" class="figure">
<p><img src="img/truncated-gaussian/2h.png" alt="2h.png" />
</p>
</div>
</div>
</div>

<div id="outline-container-org77774b3" class="outline-3">
<h3 id="org77774b3"><span class="section-number-3">31.3.</span> Stop using (Mean) Square Errors!</h3>
<div class="outline-text-3" id="text-31-3">

<div id="org3e872bc" class="figure">
<p><img src="img/truncated-gaussian/2g.png" alt="2g.png" />
</p>
</div>
</div>
</div>

<div id="outline-container-org1006756" class="outline-3">
<h3 id="org1006756"><span class="section-number-3">31.4.</span> Stop using (Mean) Square Errors!</h3>
<div class="outline-text-3" id="text-31-4">

<div id="org854d4f8" class="figure">
<p><img src="img/truncated-gaussian/2f.png" alt="2f.png" />
</p>
</div>
</div>
</div>

<div id="outline-container-org3389c17" class="outline-3">
<h3 id="org3389c17"><span class="section-number-3">31.5.</span> Stop using (Mean) Square Errors!</h3>
<div class="outline-text-3" id="text-31-5">

<div id="orgeeae792" class="figure">
<p><img src="img/truncated-gaussian/2e.png" alt="2e.png" />
</p>
</div>
</div>
</div>

<div id="outline-container-orgaa2e0b9" class="outline-3">
<h3 id="orgaa2e0b9"><span class="section-number-3">31.6.</span> Stop using (Mean) Square Errors!</h3>
<div class="outline-text-3" id="text-31-6">

<div id="orgc6fb401" class="figure">
<p><img src="img/truncated-gaussian/2d.png" alt="2d.png" />
</p>
</div>
</div>
</div>

<div id="outline-container-orge72f676" class="outline-3">
<h3 id="orge72f676"><span class="section-number-3">31.7.</span> Stop using (Mean) Square Errors!</h3>
<div class="outline-text-3" id="text-31-7">

<div id="org5e7bc7b" class="figure">
<p><img src="img/truncated-gaussian/2c.png" alt="2c.png" />
</p>
</div>
</div>
</div>

<div id="outline-container-orgf40b6d1" class="outline-3">
<h3 id="orgf40b6d1"><span class="section-number-3">31.8.</span> Stop using (Mean) Square Errors!</h3>
<div class="outline-text-3" id="text-31-8">

<div id="org9f76ccb" class="figure">
<p><img src="img/truncated-gaussian/2b.png" alt="2b.png" />
</p>
</div>
</div>
</div>

<div id="outline-container-org8f58f69" class="outline-3">
<h3 id="org8f58f69"><span class="section-number-3">31.9.</span> Stop using (Mean) Square Errors!</h3>
<div class="outline-text-3" id="text-31-9">

<div id="org799aac2" class="figure">
<p><img src="img/truncated-gaussian/2a.png" alt="2a.png" />
</p>
</div>
</div>
</div>

<div id="outline-container-org969e7f9" class="outline-3">
<h3 id="org969e7f9"><span class="section-number-3">31.10.</span> Stop using (Mean) Square Errors!</h3>
<div class="outline-text-3" id="text-31-10">

<div id="orgfe81c98" class="figure">
<p><img src="img/truncated-gaussian/2.png" alt="2.png" />
</p>
</div>
</div>
</div>
</div>

<div id="outline-container-org3085dd1" class="outline-2">
<h2 id="org3085dd1"><span class="section-number-2">32.</span> </h2>
<div class="outline-text-2" id="text-32">

<div id="orgccb4168" class="figure">
<p><img src="img/truncated-gaussian/3c.png" alt="3c.png" />
</p>
</div>
</div>

<div id="outline-container-org9e45d8e" class="outline-3">
<h3 id="org9e45d8e"><span class="section-number-3">32.1.</span> </h3>
<div class="outline-text-3" id="text-32-1">

<div id="orge83b450" class="figure">
<p><img src="img/truncated-gaussian/3b.png" alt="3b.png" />
</p>
</div>
</div>
</div>

<div id="outline-container-org13e2a6c" class="outline-3">
<h3 id="org13e2a6c"><span class="section-number-3">32.2.</span> </h3>
<div class="outline-text-3" id="text-32-2">

<div id="org89fc2b2" class="figure">
<p><img src="img/truncated-gaussian/3a.png" alt="3a.png" />
</p>
</div>
</div>
</div>

<div id="outline-container-org46e42af" class="outline-3">
<h3 id="org46e42af"><span class="section-number-3">32.3.</span> </h3>
<div class="outline-text-3" id="text-32-3">

<div id="org9064c54" class="figure">
<p><img src="img/truncated-gaussian/3.png" alt="3.png" />
</p>
</div>
</div>
</div>
</div>

<div id="outline-container-org58c3e16" class="outline-2">
<h2 id="org58c3e16"><span class="section-number-2">33.</span> Thinking with Distributions</h2>
<div class="outline-text-2" id="text-33">
<p>
Is $\mathcal{N}(\mu,\sigma)$ the correct distribution for $h^*$?
</p>


<div id="org94fa3ab" class="figure">
<p><img src="img/truncated-gaussian/4e.png" alt="4e.png" />
</p>
</div>
</div>

<div id="outline-container-org72421cb" class="outline-3">
<h3 id="org72421cb"><span class="section-number-3">33.1.</span> Thinking with Distributions</h3>
<div class="outline-text-3" id="text-33-1">
<p>
Is $\mathcal{N}(\mu,\sigma)$ the correct distribution for $h^*$?
</p>


<div id="orgf30f21c" class="figure">
<p><img src="img/truncated-gaussian/4d.png" alt="4d.png" />
</p>
</div>
</div>
</div>

<div id="outline-container-orgee64806" class="outline-3">
<h3 id="orgee64806"><span class="section-number-3">33.2.</span> Thinking with Distributions</h3>
<div class="outline-text-3" id="text-33-2">
<p>
Is $\mathcal{N}(\mu,\sigma)$ the correct distribution for $h^*$?
</p>


<div id="org2f7e7cc" class="figure">
<p><img src="img/truncated-gaussian/4c.png" alt="4c.png" />
</p>
</div>
</div>
</div>

<div id="outline-container-orgec55ed8" class="outline-3">
<h3 id="orgec55ed8"><span class="section-number-3">33.3.</span> Thinking with Distributions</h3>
<div class="outline-text-3" id="text-33-3">
<p>
Is $\mathcal{N}(\mu,\sigma)$ the correct distribution for $h^*$?
</p>


<div id="orgc655a5d" class="figure">
<p><img src="img/truncated-gaussian/4b.png" alt="4b.png" />
</p>
</div>
</div>
</div>

<div id="outline-container-org71fdd02" class="outline-3">
<h3 id="org71fdd02"><span class="section-number-3">33.4.</span> Thinking with Distributions</h3>
<div class="outline-text-3" id="text-33-4">
<p>
Is $\mathcal{N}(\mu,\sigma)$ the correct distribution for $h^*$?
</p>


<div id="org15cf346" class="figure">
<p><img src="img/truncated-gaussian/4a.png" alt="4a.png" />
</p>
</div>
</div>
</div>

<div id="outline-container-org02e695c" class="outline-3">
<h3 id="org02e695c"><span class="section-number-3">33.5.</span> Thinking with Distributions</h3>
<div class="outline-text-3" id="text-33-5">
<p>
Is $\mathcal{N}(\mu,\sigma)$ the correct distribution for $h^*$?
</p>


<div id="org37a0a94" class="figure">
<p><img src="img/truncated-gaussian/4.png" alt="4.png" />
</p>
</div>
</div>
</div>
</div>

<div id="outline-container-orgf332665" class="outline-2">
<h2 id="orgf332665"><span class="section-number-2">34.</span> What is the correct distribution?</h2>
<div class="outline-text-2" id="text-34">
<ul class="org-ul">
<li><p>
Follow the <b><i>Maximum Entropy Principle</i></b> (Jaynes 1957):
</p>

<blockquote>
<ul class="org-ul">
<li><i>Choose the distribution with the <b>largest entropy</b></i></li>
<li><i>among those that satisfy the <b>expert knowledge / constraint</b>.</i></li>
</ul>
</blockquote></li>

<li><div class="alignright" id="org8f45eb6">
<div class="larger" id="org1ac0ef0">
<p>
↪ We know a lower bound $h\le h^*$ !
</p>

<p>
<b>This is our expert knowledge!</b>
</p>

</div>

</div></li>
</ul>
</div>
</div>

<div id="outline-container-org1363b79" class="outline-2">
<h2 id="org1363b79"><span class="section-number-2">35.</span> What is the max-ent distribution for our assumption?</h2>
<div class="outline-text-2" id="text-35">

<div id="orga0332db" class="figure">
<p><img src="img/truncated-gaussian/5c.png" alt="5c.png" />
</p>
</div>
</div>

<div id="outline-container-org84400e4" class="outline-3">
<h3 id="org84400e4"><span class="section-number-3">35.1.</span> What is the max-ent distribution for our assumption?</h3>
<div class="outline-text-3" id="text-35-1">

<div id="org8d26ab5" class="figure">
<p><img src="img/truncated-gaussian/5b.png" alt="5b.png" />
</p>
</div>
</div>
</div>

<div id="outline-container-orge7ba1be" class="outline-3">
<h3 id="orge7ba1be"><span class="section-number-3">35.2.</span> What is the max-ent distribution for our assumption?</h3>
<div class="outline-text-3" id="text-35-2">

<div id="org3dbebc0" class="figure">
<p><img src="img/truncated-gaussian/5a.png" alt="5a.png" />
</p>
</div>
</div>
</div>

<div id="outline-container-org354c41d" class="outline-3">
<h3 id="org354c41d"><span class="section-number-3">35.3.</span> Results</h3>
<div class="outline-text-3" id="text-35-3">

<div id="orgb96dde5" class="figure">
<p><img src="img/truncated-gaussian/6.png" alt="6.png" />
</p>
</div>
</div>
</div>
</div>

<div id="outline-container-orgd2f0fa4" class="outline-2">
<h2 id="orgd2f0fa4"><span class="section-number-2">36.</span> IJCAI 2024 : Conclusion</h2>
<div class="outline-text-2" id="text-36">
<div class="container-fluid" id="org6e6663d">
<div class="row-fluid" id="orgc079b7f">
<div class="span6" id="org744c5d2">
<ul class="org-ul">
<li><p>
<b>We learn</b> $h^*$
</p>


<div id="org3d2e109" class="figure">
<p><img src="img/truncated-gaussian/1.png" alt="1.png" />
</p>
</div></li>
</ul>

</div>
<div class="span6" id="org1bc3393">
<ul class="org-ul">
<li><p>
<b>Square error = Gaussian</b>
</p>


<div id="orgded514d" class="figure">
<p><img src="img/truncated-gaussian/3.png" alt="3.png" />
</p>
</div></li>
</ul>

</div>

</div>
<div class="row-fluid" id="orgd94da04">
<div class="span6" id="orgaa26745">
<ul class="org-ul">
<li><p>
<b>Gaussian is a lie</b>
</p>


<div id="org74d7097" class="figure">
<p><img src="img/truncated-gaussian/4.png" alt="4.png" />
</p>
</div></li>
</ul>

</div>
<div class="span6" id="orgc306271">
<ul class="org-ul">
<li><p>
<b>Max-ent: Truncated Gaussian</b>
</p>


<div id="org0663036" class="figure">
<p><img src="img/truncated-gaussian/5a.png" alt="5a.png" />
</p>
</div></li>
</ul>

</div>

</div>

</div>

<p>
Take-home message: <b>Whenever you see a square error, doubt it!</b>
</p>
</div>
</div>

<div id="outline-container-orgc15b7dd" class="outline-2">
<h2 id="orgc15b7dd"><span class="section-number-2">37.</span> 理性的な実世界エージェントのアーキテクチャ</h2>
<div class="outline-text-2" id="text-37">
<div class="container-fluid" id="org6e480e2">
<div class="row-fluid" id="org2a30717">
<div class="span3" id="orgd5abfa1">

<div id="orga806c87" class="figure">
<p><img src="img/static/mars/yoda-hmph.gif" alt="yoda-hmph.gif" />
</p>
</div>

</div>
<div class="span9" id="orgab7c25c">

<div id="org23b4b0a" class="figure">
<p><img src="img/nesyarch/0b.png" alt="0b.png" />
</p>
</div>

</div>

</div>

</div>
</div>
</div>

<div id="outline-container-org3e146b8" class="outline-2">
<h2 id="org3e146b8"><span class="section-number-2">38.</span> 探索アルゴリズムの改善:</h2>
<div class="outline-text-2" id="text-38">
<div class="container-fluid" id="orgcbe5718">
<div class="row-fluid" id="orgc2cf488">
<div class="span6" id="org1ebf1c8">
<div class="xlarge" id="org7834663">
<div class="org-center">
<p>
MCTS + Gaussian Bandit
</p>

<p>
(ECAI 2024)
</p>
</div>

</div>

</div>
<div class="span6" id="org60d812f">
<div class="xlarge" id="org49c3190">
<div class="org-center">
<p>
MCTS + Power Bandit
</p>

<p>
(SoCS 2024 extended abstract)
</p>
</div>

</div>

</div>

</div>

</div>
</div>
</div>

<div id="outline-container-org04630a4" class="outline-2">
<h2 id="org04630a4"><span class="section-number-2">39.</span> ECAI 2024</h2>
<div class="outline-text-2" id="text-39">

<div id="org19b41c2" class="figure">
<p><img src="img/scale-invariant/title.png" alt="title.png" />
</p>
</div>
</div>
</div>

<div id="outline-container-org9d35b65" class="outline-2">
<h2 id="org9d35b65"><span class="section-number-2">40.</span> Monte Carlo Tree Search (General version)</h2>
<div class="outline-text-2" id="text-40">

<div id="org1e99a8f" class="figure">
<p><img src="img/search/mcts01.png" alt="mcts01.png" />
</p>
</div>
</div>

<div id="outline-container-org937e9e9" class="outline-3">
<h3 id="org937e9e9"><span class="section-number-3">40.1.</span> Monte Carlo Tree Search (General version)</h3>
<div class="outline-text-3" id="text-40-1">

<div id="org76ed5c3" class="figure">
<p><img src="img/search/mcts02.png" alt="mcts02.png" />
</p>
</div>
</div>
</div>

<div id="outline-container-org9458a38" class="outline-3">
<h3 id="org9458a38"><span class="section-number-3">40.2.</span> Monte Carlo Tree Search (General version)</h3>
<div class="outline-text-3" id="text-40-2">

<div id="orgca1e292" class="figure">
<p><img src="img/search/mcts03.png" alt="mcts03.png" />
</p>
</div>
</div>
</div>

<div id="outline-container-org29416c9" class="outline-3">
<h3 id="org29416c9"><span class="section-number-3">40.3.</span> Monte Carlo Tree Search (General version)</h3>
<div class="outline-text-3" id="text-40-3">

<div id="org1c20a4d" class="figure">
<p><img src="img/search/mcts04.png" alt="mcts04.png" />
</p>
</div>
</div>
</div>

<div id="outline-container-org19decf0" class="outline-3">
<h3 id="org19decf0"><span class="section-number-3">40.4.</span> Monte Carlo Tree Search (General version)</h3>
<div class="outline-text-3" id="text-40-4">

<div id="org4d95688" class="figure">
<p><img src="img/search/mcts05.png" alt="mcts05.png" />
</p>
</div>
</div>
</div>

<div id="outline-container-orga512b4d" class="outline-3">
<h3 id="orga512b4d"><span class="section-number-3">40.5.</span> Monte Carlo Tree Search (General version)</h3>
<div class="outline-text-3" id="text-40-5">

<div id="org6240a0e" class="figure">
<p><img src="img/search/mcts06.png" alt="mcts06.png" />
</p>
</div>
</div>
</div>

<div id="outline-container-org8f2eb0e" class="outline-3">
<h3 id="org8f2eb0e"><span class="section-number-3">40.6.</span> Monte Carlo Tree Search (General version)</h3>
<div class="outline-text-3" id="text-40-6">

<div id="org1b40c89" class="figure">
<p><img src="img/search/mcts07.png" alt="mcts07.png" />
</p>
</div>
</div>
</div>

<div id="outline-container-org0968eff" class="outline-3">
<h3 id="org0968eff"><span class="section-number-3">40.7.</span> Monte Carlo Tree Search (General version)</h3>
<div class="outline-text-3" id="text-40-7">

<div id="orgad26341" class="figure">
<p><img src="img/search/mcts08.png" alt="mcts08.png" />
</p>
</div>
</div>
</div>

<div id="outline-container-orgc0b7638" class="outline-3">
<h3 id="orgc0b7638"><span class="section-number-3">40.8.</span> Monte Carlo Tree Search (General version)</h3>
<div class="outline-text-3" id="text-40-8">

<div id="org0008700" class="figure">
<p><img src="img/search/mcts08.png" alt="mcts08.png" />
</p>
</div>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">　　　　　　</th>
<th scope="col" class="org-left">Heuristic function 　</th>
<th scope="col" class="org-left">　　　　　　　　　　　</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">Game</td>
<td class="org-left">✗ Hand-coded</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">(e.g., Go)</td>
<td class="org-left">✗ Not accurate</td>
<td class="org-left">&#xa0;</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="org-left">　　　　　　</td>
<td class="org-left">　</td>
<td class="org-left">　</td>
</tr>

<tr>
<td class="org-left">　　　　　　</td>
<td class="org-left">　</td>
<td class="org-left">　</td>
</tr>
</tbody>
</table>
</div>
</div>

<div id="outline-container-orgb016ec0" class="outline-3">
<h3 id="orgb016ec0"><span class="section-number-3">40.9.</span> Monte Carlo Tree Search (General version)</h3>
<div class="outline-text-3" id="text-40-9">

<div id="orgd48e853" class="figure">
<p><img src="img/search/mcts08.png" alt="mcts08.png" />
</p>
</div>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">　　　　　　</th>
<th scope="col" class="org-left">Heuristic function 　</th>
<th scope="col" class="org-left">Simulation / Rollout</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">Game</td>
<td class="org-left">✗ Hand-coded</td>
<td class="org-left">✔ Finite horizon (9x9)</td>
</tr>

<tr>
<td class="org-left">(e.g., Go)</td>
<td class="org-left">✗ Not accurate</td>
<td class="org-left">&#xa0;</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="org-left">　　　　　　</td>
<td class="org-left">　</td>
<td class="org-left">　</td>
</tr>

<tr>
<td class="org-left">　　　　　　</td>
<td class="org-left">　</td>
<td class="org-left">　</td>
</tr>
</tbody>
</table>
</div>
</div>

<div id="outline-container-orgcda9df3" class="outline-3">
<h3 id="orgcda9df3"><span class="section-number-3">40.10.</span> Monte Carlo Tree Search (General version)</h3>
<div class="outline-text-3" id="text-40-10">

<div id="org3c6442f" class="figure">
<p><img src="img/search/mcts08.png" alt="mcts08.png" />
</p>
</div>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">　　　　　　</th>
<th scope="col" class="org-left">Heuristic function 　</th>
<th scope="col" class="org-left">Simulation / Rollout</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">Game</td>
<td class="org-left">✗ Hand-coded</td>
<td class="org-left">✔ Finite horizon (9x9)</td>
</tr>

<tr>
<td class="org-left">(e.g., Go)</td>
<td class="org-left">✗ Not accurate</td>
<td class="org-left">✔ Dense reward</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="org-left">　　　　　　</td>
<td class="org-left">　</td>
<td class="org-left">　</td>
</tr>

<tr>
<td class="org-left">　　　　　　</td>
<td class="org-left">　</td>
<td class="org-left">　</td>
</tr>
</tbody>
</table>
</div>
</div>

<div id="outline-container-org0410d0c" class="outline-3">
<h3 id="org0410d0c"><span class="section-number-3">40.11.</span> Monte Carlo Tree Search (General version)</h3>
<div class="outline-text-3" id="text-40-11">

<div id="orga873f84" class="figure">
<p><img src="img/search/mcts08.png" alt="mcts08.png" />
</p>
</div>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">　　　　　　</th>
<th scope="col" class="org-left">Heuristic function 　</th>
<th scope="col" class="org-left">Simulation / Rollout</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">Game</td>
<td class="org-left">✗ Hand-coded</td>
<td class="org-left">✔ Finite horizon (9x9)</td>
</tr>

<tr>
<td class="org-left">(e.g., Go)</td>
<td class="org-left">✗ Not accurate</td>
<td class="org-left">✔ Dense reward</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="org-left">Classical</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">Planning</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>
</tbody>
</table>
</div>
</div>

<div id="outline-container-org4713a3d" class="outline-3">
<h3 id="org4713a3d"><span class="section-number-3">40.12.</span> Monte Carlo Tree Search (General version)</h3>
<div class="outline-text-3" id="text-40-12">

<div id="org0fe8624" class="figure">
<p><img src="img/search/mcts08.png" alt="mcts08.png" />
</p>
</div>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">　　　　　　</th>
<th scope="col" class="org-left">Heuristic function 　</th>
<th scope="col" class="org-left">Simulation / Rollout</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">Game</td>
<td class="org-left">✗ Hand-coded</td>
<td class="org-left">✔ Finite horizon (9x9)</td>
</tr>

<tr>
<td class="org-left">(e.g., Go)</td>
<td class="org-left">✗ Not accurate</td>
<td class="org-left">✔ Dense reward</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="org-left">Classical</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">✗ Infinite horizon</td>
</tr>

<tr>
<td class="org-left">Planning</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>
</tbody>
</table>
</div>
</div>

<div id="outline-container-org8a97dd0" class="outline-3">
<h3 id="org8a97dd0"><span class="section-number-3">40.13.</span> Monte Carlo Tree Search (General version)</h3>
<div class="outline-text-3" id="text-40-13">

<div id="org34d2ec1" class="figure">
<p><img src="img/search/mcts08.png" alt="mcts08.png" />
</p>
</div>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">　　　　　　</th>
<th scope="col" class="org-left">Heuristic function 　</th>
<th scope="col" class="org-left">Simulation / Rollout</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">Game</td>
<td class="org-left">✗ Hand-coded</td>
<td class="org-left">✔ Finite horizon (9x9)</td>
</tr>

<tr>
<td class="org-left">(e.g., Go)</td>
<td class="org-left">✗ Not accurate</td>
<td class="org-left">✔ Dense reward</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="org-left">Classical</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">✗ Infinite horizon</td>
</tr>

<tr>
<td class="org-left">Planning</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">✗ Sparse reward</td>
</tr>
</tbody>
</table>
</div>
</div>

<div id="outline-container-orgac45b94" class="outline-3">
<h3 id="orgac45b94"><span class="section-number-3">40.14.</span> Monte Carlo Tree Search (General version)</h3>
<div class="outline-text-3" id="text-40-14">

<div id="org5e743bc" class="figure">
<p><img src="img/search/mcts08.png" alt="mcts08.png" />
</p>
</div>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">　　　　　　</th>
<th scope="col" class="org-left">Heuristic function 　</th>
<th scope="col" class="org-left">Simulation / Rollout</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">Game</td>
<td class="org-left">✗ Hand-coded</td>
<td class="org-left">✔ Finite horizon (9x9)</td>
</tr>

<tr>
<td class="org-left">(e.g., Go)</td>
<td class="org-left">✗ Not accurate</td>
<td class="org-left">✔ Dense reward</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="org-left">Classical</td>
<td class="org-left">✔ Automated</td>
<td class="org-left">✗ Infinite horizon</td>
</tr>

<tr>
<td class="org-left">Planning</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">✗ Sparse reward</td>
</tr>
</tbody>
</table>
</div>
</div>

<div id="outline-container-org1fbd98d" class="outline-3">
<h3 id="org1fbd98d"><span class="section-number-3">40.15.</span> Monte Carlo Tree Search (General version)</h3>
<div class="outline-text-3" id="text-40-15">

<div id="orga07927a" class="figure">
<p><img src="img/search/mcts08.png" alt="mcts08.png" />
</p>
</div>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">　　　　　　</th>
<th scope="col" class="org-left"><b><i>Heuristic function</i></b> 　</th>
<th scope="col" class="org-left">Simulation / Rollout</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">Game</td>
<td class="org-left">✗ Hand-coded</td>
<td class="org-left">✔ Finite horizon (9x9)</td>
</tr>

<tr>
<td class="org-left">(e.g., Go)</td>
<td class="org-left">✗ Not accurate</td>
<td class="org-left">✔ Dense reward</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="org-left">Classical</td>
<td class="org-left">✔ Automated</td>
<td class="org-left">✗ Infinite horizon</td>
</tr>

<tr>
<td class="org-left">Planning</td>
<td class="org-left">✔ Domain-Independent</td>
<td class="org-left">✗ Sparse reward</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>

<div id="outline-container-org2478fbd" class="outline-2">
<h2 id="org2478fbd"><span class="section-number-2">41.</span> Backup in MCTS : Avg</h2>
<div class="outline-text-2" id="text-41">

<div id="orgbb76837" class="figure">
<p><img src="img/tree-based/1.png" alt="1.png" />
</p>
</div>
</div>

<div id="outline-container-orge6cac53" class="outline-3">
<h3 id="orge6cac53"><span class="section-number-3">41.1.</span> Backup in MCTS : Avg vs. Min</h3>
<div class="outline-text-3" id="text-41-1">

<div id="org604dffc" class="figure">
<p><img src="img/tree-based/2.png" alt="2.png" />
</p>
</div>
</div>
</div>


<div id="outline-container-orgdcbe526" class="outline-3">
<h3 id="orgdcbe526"><span class="section-number-3">41.2.</span> Backup in MCTS : Avg vs. Min = <b><i>GBFS, A*</i></b></h3>
<div class="outline-text-3" id="text-41-2">

<div id="orge2a3ad5" class="figure">
<p><img src="img/tree-based/3.png" alt="3.png" />
</p>
</div>

<div class="org-center">
<div class="xlarge" id="org2c647ce">
<ul class="org-ul">
<li><b>GBFS: Traditional SotA</b></li>
<li><p>
UCT has been <span class="underline"><i>bad</i></span>
</p>

<p>
(UCT = MCTS+UCB1)
</p></li>
</ul>

</div>
</div>

<div class="note" id="org24df8c3">
<p>
Schulte and Keller. "Balancing exploration and exploitation in classical planning." SOCS, 2014
</p>

</div>
</div>
</div>
</div>

<div id="outline-container-org954f272" class="outline-2">
<h2 id="org954f272"><span class="section-number-2">42.</span> Why: <b><i>Poor theoretical understanding</i></b> of bandits.</h2>
<div class="outline-text-2" id="text-42">
<blockquote>
<p>
$\text{UCB1}_i = \mu_i-c\sqrt{\frac{\log N}{n_i}}$ , <b>for</b> $\mu_i \in [0,c]$
</p>

<div class="org-center">
<p>
$N$: parent visit, $n_i$: visit for child $i$
</p>

<p>
$\mu_i$ : mean over the subtree of $i$
</p>
</div>
</blockquote>

<ul class="org-ul">
<li><b>Rewards must have a <i>known, fixed, shared reward range</i></b>.

<ul class="org-ul">
<li><p>
But $h(s)$ <b>have <i>no known range!</i></b>
</p>

<p>
<span class="underline">Requirments unsatisfied. All theoretical guarantees violated.</span>
</p></li>
</ul></li>

<li><p>
<b>Our solution: Gaussian Bandit</b> defined on <b>Entire</b> $\mathbb{R}=[-\infty,\infty]$
</p>

<blockquote>
<p>
$\text{UCB1-Normal2}_i = \mu_i-\sigma_i \sqrt{\log N}$ , <b>for</b> $\mu_i \in \mathbb{R}$
</p>

<div class="org-center">
<p>
$\mu_i, \sigma_i$ : mean / stdev over the subtree of $i$
</p>
</div>
</blockquote></li>
</ul>
</div>
</div>

<div id="outline-container-orgdc97e69" class="outline-2">
<h2 id="orgdc97e69"><span class="section-number-2">43.</span> Results (ECAI 2024)</h2>
<div class="outline-text-2" id="text-43">

<div id="orga5aa42d" class="figure">
<p><img src="img/static/ecai24-results.png" alt="ecai24-results.png" />
</p>
</div>
</div>
</div>

<div id="outline-container-org446c813" class="outline-2">
<h2 id="org446c813"><span class="section-number-2">44.</span> New Algorithm : Model the minimum <b><i>correctly</i></b></h2>
<div class="outline-text-2" id="text-44">
<p>
Fit the data to&#x2026;
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-center" />
</colgroup>
<tbody>
<tr>
<td class="org-left">UCB1</td>
<td class="org-left"><b>a <i>known</i> finite support distribution</b></td>
<td class="org-center">$[0,1]$ , $[3,5]$</td>
</tr>

<tr>
<td class="org-left">UCB1-Normal</td>
<td class="org-left"><b>a Gaussian distribution</b></td>
<td class="org-center">$[-\infty,\infty]$</td>
</tr>
</tbody>
</table>

<blockquote>
<ul class="org-ul">
<li><b>Do heuristics have <i>known</i> bounds e.g. $[3,5]$ ? <i>No!</i></b></li>

<li><p>
<b>Are heuristic samples $\in[-\infty,\infty]$ ? <i>No! It is non-negative!</i></b>
</p>

<p>
$0 \ge h(s)$
</p></li>
</ul>

<div class="larger" id="org6f4e090">
<div class="org-center">
<ul class="org-ul">
<li><b>Gaussian assumption is <i>STILL WRONG</i></b></li>
</ul>
</div>

</div>
</blockquote>
</div>
</div>

<div id="outline-container-org6e7c181" class="outline-2">
<h2 id="org6e7c181"><span class="section-number-2">45.</span> What distribution is the right answer?</h2>
<div class="outline-text-2" id="text-45">
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">&#xa0;</th>
<th scope="col" class="org-left">Range</th>
<th scope="col" class="org-left">How it is distributed?</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">Gaussian</td>
<td class="org-left"><span class="underline"><i>Unbounded</i></span> ✗</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">Exponential</td>
<td class="org-left"><b><i>Half-Bounded</i></b></td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">Uniform</td>
<td class="org-left"><b><i>Bounded</i></b></td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">　　　　　　　　　　　　　　　　　</td>
</tr>
</tbody>
</table>



<div id="org74ecb43" class="figure">
<p><img src="img/scale-invariant/candidate-distribution.png" alt="candidate-distribution.png" />
</p>
</div>
</div>

<div id="outline-container-org269a135" class="outline-3">
<h3 id="org269a135"><span class="section-number-3">45.1.</span> What distribution is the right answer?</h3>
<div class="outline-text-3" id="text-45-1">
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">&#xa0;</th>
<th scope="col" class="org-left">Range</th>
<th scope="col" class="org-left">How it is distributed?</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">Gaussian</td>
<td class="org-left"><span class="underline"><i>Unbounded</i></span> ✗</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">Exponential</td>
<td class="org-left"><b><i>Half-Bounded</i></b></td>
<td class="org-left"><span class="underline"><i>Smallest value is most common</i></span> ✗</td>
</tr>

<tr>
<td class="org-left">Uniform</td>
<td class="org-left"><b><i>Bounded</i></b></td>
<td class="org-left">Equally likely around min and max</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">　　　　　　　　　　　　　　　　　</td>
</tr>
</tbody>
</table>


<div id="orge53cd4e" class="figure">
<p><img src="img/scale-invariant/candidate-distribution.png" alt="candidate-distribution.png" />
</p>
</div>
</div>
</div>

<div id="outline-container-org29c42d8" class="outline-3">
<h3 id="org29c42d8"><span class="section-number-3">45.2.</span> What distribution is the right answer?</h3>
<div class="outline-text-3" id="text-45-2">
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">&#xa0;</th>
<th scope="col" class="org-left">Range</th>
<th scope="col" class="org-left">How it is distributed?</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">Gaussian</td>
<td class="org-left"><span class="underline"><i>Unbounded</i></span> ✗</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">Exponential</td>
<td class="org-left"><b><i>Half-Bounded</i></b></td>
<td class="org-left"><span class="underline"><i>Smallest value is most common</i></span> ✗</td>
</tr>

<tr>
<td class="org-left">Uniform</td>
<td class="org-left"><b><i>Bounded</i></b></td>
<td class="org-left">Equally likely around min and max</td>
</tr>

<tr>
<td class="org-left"><b>Power</b></td>
<td class="org-left"><b><i>Bounded</i></b></td>
<td class="org-left"><b><i>Smallest value is rare</i></b></td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">　　　　　　　　　　　　　　　　　</td>
</tr>
</tbody>
</table>


<div id="org9ae7ab3" class="figure">
<p><img src="img/scale-invariant/power.png" alt="power.png" />
</p>
</div>
</div>
</div>
</div>

<div id="outline-container-org01ec8bb" class="outline-2">
<h2 id="org01ec8bb"><span class="section-number-2">46.</span> But Why? <b><i>What theory</i></b> justifies Power?</h2>
<div class="outline-text-2" id="text-46">
<p>
<b>Central Limit Theorem</b>: Given i.i.d. RVs $x_0, \ldots x_n$, there is a sequence $a_n&gt;0, b_n$ s.t. $\exists \mu, \sigma$
</p>

<p>
\[
 S_n= \sum_{i=0}^n \frac{x_i-b_n}{a_n}  \longrightarrow \mathcal{N}(\mu, \sigma)
\]
</p>
</div>

<div id="outline-container-org647bf99" class="outline-3">
<h3 id="org647bf99"><span class="section-number-3">46.1.</span> But Why? <b><i>What theory</i></b> justifies Power?</h3>
<div class="outline-text-3" id="text-46-1">
<p>
<b>Central Limit Theorem</b>: Given i.i.d. RVs $x_0, \ldots x_n$, there is a sequence $a_n&gt;0, b_n$ s.t. $\exists \mu, \sigma$
</p>

<p>
\[
 S_n= \sum_{i=0}^n \frac{x_i-b_n}{a_n}  \longrightarrow \mathcal{N}(\mu, \sigma)
\]
</p>

<p>
<b>Extreme Value Theorem type 1</b>: Given i.i.d. RVs $x_0, \ldots x_n$, there is a sequence $a_n&gt;0, b_n$ s.t. $\exists \mu, \sigma, \xi$
</p>

<p>
\[
 M_n= \max     \frac{x_i-b_n}{a_n}  \longrightarrow \mathrm{EVD}(\mu, \sigma, \xi)
\]
</p>
</div>
</div>

<div id="outline-container-orgcedd8c9" class="outline-3">
<h3 id="orgcedd8c9"><span class="section-number-3">46.2.</span> But Why? <b><i>What theory</i></b> justifies Power?</h3>
<div class="outline-text-3" id="text-46-2">
<p>
<b>Central Limit Theorem</b>: Given i.i.d. RVs $x_0, \ldots x_n$, there is a sequence $a_n&gt;0, b_n$ s.t. $\exists \mu, \sigma$
</p>

<p>
\[
 S_n= \sum_{i=0}^n \frac{x_i-b_n}{a_n}  \longrightarrow \mathcal{N}(\mu, \sigma)
\]
</p>

<p>
<b>Extreme Value Theorem type 1</b>: Given i.i.d. RVs $x_0, \ldots x_n$, there is a sequence $a_n&gt;0, b_n$ s.t. $\exists \mu, \sigma, \xi$
</p>

<p>
\[
 M_n= \max     \frac{x_i-b_n}{a_n}  \longrightarrow \mathrm{EVD}(\mu, \sigma, \xi)
\]
</p>

<p>
<b><i>Extreme Value Theorem type 2</i></b>: Given i.i.d. RVs $x_0 &lt; \ldots &lt; x_k &lt; \ldots &lt; x_n$, there is a sequence $a_n&gt;0, b_n$ s.t. $\exists \mu, \sigma, \xi$
</p>

<p>
\[
  p(x | x &gt; x_k)  \longrightarrow \mathrm{GPD}(\mu, \sigma, \xi)
\]
</p>

<p>
$\mathrm{GPD}$ : <b><i>Generalized Pareto Distribution</i></b> is the way to go. <b>Why?</b>
</p>
</div>
</div>

<div id="outline-container-orga5ab02e" class="outline-3">
<h3 id="orga5ab02e"><span class="section-number-3">46.3.</span> Power, Uniform, Exponential, Pareto are special cases of Generalized Pareto $\mathrm{GPD}(\theta, \sigma, \xi)$.</h3>
<div class="outline-text-3" id="text-46-3">
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-center" />

<col  class="org-center" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">&#xa0;</th>
<th scope="col" class="org-center">min</th>
<th scope="col" class="org-center">max</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">$\xi&gt;0$ = Pareto</td>
<td class="org-center">$\theta$</td>
<td class="org-center">$\infty$</td>
</tr>

<tr>
<td class="org-left">$\xi=0$ = Exponential</td>
<td class="org-center">$\theta$</td>
<td class="org-center">$\infty$</td>
</tr>

<tr>
<td class="org-left">$\xi&lt;0$ = (Flipped) Power</td>
<td class="org-center">$\theta$</td>
<td class="org-center">$\theta-\frac{\sigma}{\xi}$</td>
</tr>

<tr>
<td class="org-left">$\xi=-1$ = Uniform</td>
<td class="org-center">$\theta$</td>
<td class="org-center">$\theta-\frac{\sigma}{\xi}$</td>
</tr>

<tr>
<td class="org-left">$\xi&lt;-1$</td>
<td class="org-center">$\theta$</td>
<td class="org-center">$\theta-\frac{\sigma}{\xi}$</td>
</tr>
</tbody>
</table>


<div id="orgf2f4008" class="figure">
<p><img src="img/static/gpd.png" alt="gpd.png" />
</p>
</div>
</div>
</div>
</div>

<div id="outline-container-org546dc98" class="outline-2">
<h2 id="org546dc98"><span class="section-number-2">47.</span> Modeling the average</h2>
<div class="outline-text-2" id="text-47">

<div id="orga2b2c03" class="figure">
<p><img src="img/clt-vs-evt/0.png" alt="0.png" />
</p>
</div>
</div>

<div id="outline-container-org0e23019" class="outline-3">
<h3 id="org0e23019"><span class="section-number-3">47.1.</span> Modeling the average = Fitting the dist. with Gaussian</h3>
<div class="outline-text-3" id="text-47-1">

<div id="org0599717" class="figure">
<p><img src="img/clt-vs-evt/1.png" alt="1.png" />
</p>
</div>
</div>
</div>

<div id="outline-container-org65763ca" class="outline-3">
<h3 id="org65763ca"><span class="section-number-3">47.2.</span> Modeling the maximum</h3>
<div class="outline-text-3" id="text-47-2">

<div id="orgd1071cb" class="figure">
<p><img src="img/clt-vs-evt/2.png" alt="2.png" />
</p>
</div>
</div>
</div>

<div id="outline-container-org05f77e9" class="outline-3">
<h3 id="org05f77e9"><span class="section-number-3">47.3.</span> Modeling the maximum = Fitting the tail dist. with GP</h3>
<div class="outline-text-3" id="text-47-3">

<div id="org8287a80" class="figure">
<p><img src="img/clt-vs-evt/3.png" alt="3.png" />
</p>
</div>
</div>
</div>
</div>

<div id="outline-container-org7e6f816" class="outline-2">
<h2 id="org7e6f816"><span class="section-number-2">48.</span> New Algorithm : Model the minimum <b><i>correctly</i></b></h2>
<div class="outline-text-2" id="text-48">
<p>
Fitting GPD itself is <b>difficult</b> (computational issue)
</p>

<p>
&rarr; fit subclasses: <b>Uniform</b> and <b>Power</b>
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">&#xa0;</th>
<th scope="col" class="org-left">Lower bound</th>
<th scope="col" class="org-left">Upper bound</th>
<th scope="col" class="org-left">Shape</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">UCB1</td>
<td class="org-left"><span class="underline"><i>Known</i></span> $0$</td>
<td class="org-left"><span class="underline"><i>Known</i></span> $1$</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">UCB1-Normal</td>
<td class="org-left">$-\infty$</td>
<td class="org-left">$\infty$</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left"><b>UCB1-Uniform</b></td>
<td class="org-left"><b><i>Unknown</i></b> $\ell$</td>
<td class="org-left"><b><i>Unknown</i></b> $u$</td>
<td class="org-left"><span class="underline"><i>Fixed, Flat</i></span></td>
</tr>

<tr>
<td class="org-left"><b>UCB1-Power</b></td>
<td class="org-left"><span class="underline"><i>Known</i></span> $0$</td>
<td class="org-left"><b><i>Unknown</i></b> $u$</td>
<td class="org-left"><b><i>Rare near goals</i></b></td>
</tr>
</tbody>
</table>


<p>
$\text{UCB1-Uniform}_i = \frac{u_i+l_i}{2} -(u_i-l_i)\sqrt{6n_i \log N}$
</p>

<p>
$\text{UCB1-Power}_i = \frac{u_ia_i}{a_i+1} -u_i\sqrt{6n_i \log N}$
</p>
</div>
</div>


<div id="outline-container-org23b4bfb" class="outline-2">
<h2 id="org23b4bfb"><span class="section-number-2">49.</span> Results (SoCS 2024 Extended Abstract)</h2>
<div class="outline-text-2" id="text-49">

<div id="org56bcf51" class="figure">
<p><img src="img/static/extreme-results.png" alt="extreme-results.png" />
</p>
</div>
</div>
</div>

<div id="outline-container-org2a19690" class="outline-2">
<h2 id="org2a19690"><span class="section-number-2">50.</span> ECAI 2024 + SoCS 2024: Conclusion</h2>
<div class="outline-text-2" id="text-50">
<div class="org-center">
<div class="container-fluid" id="org9a8a031">
<div class="row-fluid" id="org720755e">
<div class="span4" id="orgb2c30f2">
<ul class="org-ul">
<li><p>
<b>UCT is slow in</b>
</p>

<p>
Classical Planning
</p>

<p>
$\mu - c \sqrt{ \frac{\log N}{n_i} }$
</p></li>

<li><p>
<b>Why?</b>
</p>

<p>
$h(s) \not\in [0,c]$
</p>

<p>
(fixed range)
</p></li>
</ul>

</div>
<div class="span4" id="org2613265">
<ul class="org-ul">
<li><p>
(ECAI 2024)
</p>

<p>
<b>Use Gaussian Bandit!</b>
</p>

<p>
$\mu - \sigma \sqrt{ \log N }$
</p>

<p>

</p>

<p>
$h(s) \in [-\infty,\infty]$
</p>

<p>

</p></li>

<li><p>
<b><i>STILL WRONG!</i></b>
</p>

<p>
$0 \le h(s)$
</p></li>
</ul>

</div>
<div class="span4" id="org62b1ca7">
<ul class="org-ul">
<li><p>
(SoCS 2024)
</p>

<p>
<b>Use Uniform / Power!</b>
</p>

<p>
$\frac{u_i+l_i}{2} -(u_i-l_i)\sqrt{6n_i \log N}$
</p>

<p>
$\frac{u_ia_i}{a_i+1} -u_i\sqrt{6n_i \log N}$
</p></li>
</ul>

</div>

</div>

</div>

<div class="xlarge" id="org02f49e9">
<ul class="org-ul">
<li>Use bandits correctly!</li>
</ul>

</div>
</div>
</div>
</div>



<div id="outline-container-org006b0e2" class="outline-2">
<h2 id="org006b0e2"><span class="section-number-2">51.</span> Conclusion &amp; Take-home message</h2>
<div class="outline-text-2" id="text-51">
<div class="container-fluid" id="orgf758448">
<div class="row-fluid" id="org7349d62">
<div class="span8" id="org8962180">
<ul class="org-ul">
<li>記号接地:
<ul class="org-ul">
<li>PDDLを <b>正しく</b> モデル化しよう!
<ul class="org-ul">
<li>→グラフィカルモデル</li>
</ul></li>
</ul></li>
<li>ヒューリスティクス学習:
<ul class="org-ul">
<li>RL : Reward Shaping を <b>正しく</b> やろう!
<ul class="org-ul">
<li><b><i>Discouning</i></b> , <span class="underline"><i>Undiscounting</i></span></li>
</ul></li>
<li>SL : $h^*(s)$ を <b>正しく</b> モデル化しよう!
<ul class="org-ul">
<li>Truncated Gaussian</li>
</ul></li>
</ul></li>
<li>探索アルゴリズム改善 / Bandit:
<ul class="org-ul">
<li>$h(s)$ を <b>正しく</b> モデル化しよう!
<ul class="org-ul">
<li>→ Gaussian, Power</li>
</ul></li>
</ul></li>
</ul>

</div>
<div class="span4" id="orgd1c1b56">

<div id="org3adb13d" class="figure">
<p><img src="img/nesyarch/0b.png" alt="0b.png" />
</p>
</div>

<div class="larger" id="org547af4f">
<div class="org-center">
<ul class="org-ul">
<li><p>
<b>正しさへの</b>
</p>

<p>
<b>こだわりは</b>
</p>

<p>
<b>いつか</b>
</p>

<p>
<b>実を結ぶはず</b>
</p>

<p>
(大変だけど)
</p></li>
</ul>
</div>

</div>

</div>

</div>

</div>
</div>
</div>

<div id="outline-container-orgcb60bc1" class="outline-2">
<h2 id="orgcb60bc1"><span class="section-number-2">52.</span> Deep RL は <b>正しい</b> か?</h2>
<div class="outline-text-2" id="text-52">
<ul class="org-ul">
<li>研究のやり方に問題があるように思われる</li>
</ul>

<div class="container-fluid" id="orgee2f88c">
<div class="row-fluid" id="org6085cae">
<div class="span5" id="orgb94c5b6">

<div id="org91ed4c5" class="figure">
<p><img src="img/nesyarch/0b.png" alt="0b.png" />
</p>
</div>

<ul class="org-ul">
<li>Deep RL は <b>全部ごった煮</b>
<ul class="org-ul">
<li>表現学習</li>
<li>ヒューリスティック</li>
<li>探索アルゴリズム</li>
<li>Active Learning</li>
<li>Contiual Learning</li>
</ul></li>
</ul>

</div>
<div class="span7" id="org03d99f4">
<ul class="org-ul">
<li><b><i>1つの変更で全部が影響受ける</i></b>
<ul class="org-ul">
<li>なぜ性能良くなったのか、わからなくない?</li>
</ul></li>
<li><b><i>再現性の問題も、ある&#x2026;</i></b>
<ul class="org-ul">
<li>Leslie Kaelbring: RLの評価は最低20シードないと認めない！</li>
</ul></li>
<li><span class="underline"><i>The science</i></span> as a <b>sane</b> researcher:
<ul class="org-ul">
<li><span class="underline"><i>Split</i></span> the architecture into parts</li>
<li><span class="underline"><i>Study each part individually</i></span></li>
<li><span class="underline"><i>Correct mathematical modeling</i></span></li>
<li>こういうアプローチに立ち返るのがいいと思います&#x2026;</li>
</ul></li>
</ul>

</div>

</div>

</div>
</div>
</div>

<div id="outline-container-org0bbd8cf" class="outline-2">
<h2 id="org0bbd8cf"><span class="section-number-2">53.</span> LLM + Planning (, Reasoning) が成功するには?</h2>
<div class="outline-text-2" id="text-53">
<p>
単体ではおそらくプランニング不可 by Rao (Subbarao Kambhampati)
</p>

<ul class="org-ul">
<li>おおよそRLと同じような問題を抱えている (ごった煮)</li>
<li>全部一度にこなそうとしている
<ul class="org-ul">
<li><b>表現学習</b> : ここだけはとても汎化している</li>
<li><b>探索</b> : 全くしていない(Reflex Agent) か 非常に原始的 (CoT)</li>
<li><b>ヒューリスティクス</b> : 「常識」の丸暗記</li>
</ul></li>
<li>プランニングに対する <b>解像度</b> が低い</li>
</ul>

<div class="note" id="orgea55b5a">
<p>
Gundawar, Atharva, et al. "Robust Planning with LLM-Modulo Framework: Case Study in Travel Planning." arXiv
</p>

<p>
Kambhampati, Subbarao, et al. "LLMs Can't Plan, But Can Help Planning in LLM-Modulo Frameworks." arXiv
</p>

<p>
Valmeekam, Karthik, et al. "On the planning abilities of large language models-a critical investigation." Neurips 2023
</p>

</div>
</div>
</div>

<div id="outline-container-orgbb1e556" class="outline-2">
<h2 id="orgbb1e556"><span class="section-number-2">54.</span> 自分が将来的にやりそうなネタ</h2>
<div class="outline-text-2" id="text-54">
<ul class="org-ul">
<li><b>表現学習</b> : LLM を使ってPDDL生成 (Latplanと同じ)</li>
<li><b>ヒューリスティクス</b> : LLM を使ってロボットのガイド
<ul class="org-ul">
<li>Planning Modulo LLM : 探索の中からLLMを使う</li>
</ul></li>
<li><b>探索</b> : LLM で CDCL とかやると面白そう</li>
</ul>

<p>
現在あまりインターンは採用していないが、共同研究は可能!
</p>

<div class="org-center">
<p>
MIT-IBM Watson AI Lab
</p>


<div id="orgc0aac86" class="figure">
<p><img src="img/MIT-IBM.png" alt="MIT-IBM.png" />
</p>
</div>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="author">Author: Masataro Asai</p>
<p class="date">Created: 2024-09-18 Wed 00:41</p>
<p class="validation"><a href="https://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
